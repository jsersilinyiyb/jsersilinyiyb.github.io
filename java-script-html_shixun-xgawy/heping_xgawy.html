<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å’Œå¹³è¡ŒåŠ¨ä¸ç•™è¨€äº’åŠ¨å¹³å°</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.8/dist/chart.umd.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="icon" href="ico.png" type="image/png">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <style>
        /* åŸæœ‰æ ·å¼ä¿æŒä¸å˜ */
        /* æ–°å¢é¡µè„šä¼˜åŒ–æ ·å¼ */
        
        #footer {
            background: linear-gradient(135deg, #f0f7ff 0%, #ffffff 100%);
            padding: 50px 0 20px;
            border-top: 1px solid rgba(100, 100, 120, 0.3);
            margin-top: 50px;
        }
        
        .footer-container {
            max-width: 1800px;
            margin: 0 auto;
            padding: 0 20px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 30px;
        }
        
        .footer-section {
            padding: 15px;
        }
        
        .footer-section h3 {
            font-size: 1.4rem;
            color: var(--accent-gold);
            margin-bottom: 25px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--border-color);
            position: relative;
        }
        
        .footer-section h3::after {
            content: '';
            position: absolute;
            bottom: -1px;
            left: 0;
            width: 60px;
            height: 2px;
            background: var(--accent-gold);
        }
        
        .footer-about {
            grid-column: span 2;
        }
        
        .footer-about p {
            margin-bottom: 20px;
            line-height: 1.8;
        }
        
        .social-links {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }
        
        .social-links a {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(252, 163, 17, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--accent-gold);
            transition: all 0.3s ease;
        }
        
        .social-links a:hover {
            background: var(--accent-gold);
            color: #000;
            transform: translateY(-3px);
        }
        
        .footer-links {
            list-style: none;
        }
        
        .footer-links li {
            margin-bottom: 15px;
        }
        
        .footer-links a {
            color: var(--light-text);
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s ease;
        }
        
        .footer-links a:hover {
            color: var(--accent-gold);
            transform: translateX(5px);
        }
        
        .footer-links a i {
            color: var(--accent-gold);
            font-size: 0.8rem;
        }
        
        .contact-info {
            list-style: none;
        }
        
        .contact-info li {
            margin-bottom: 20px;
            display: flex;
            align-items: flex-start;
            gap: 15px;
        }
        
        .contact-info i {
            color: var(--accent-gold);
            font-size: 1.2rem;
            min-width: 24px;
            margin-top: 3px;
        }
        
        .friend-links {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
        }
        
        .friend-links a {
            color: var(--light-text);
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s ease;
        }
        
        .friend-links a:hover {
            color: var(--accent-gold);
        }
        
        .friend-links a i {
            color: var(--accent-gold);
            font-size: 0.9rem;
        }
        
        .copyright {
            margin-top: 50px;
            padding-top: 25px;
            border-top: 1px solid var(--border-color);
            text-align: center;
            font-size: 0.85rem;
            line-height: 1.8;
            opacity: 0.7;
        }
        
        .copyright strong {
            color: var(--accent-gold);
            font-weight: 600;
        }
        /* å“åº”å¼è°ƒæ•´ */
        
        @media (max-width: 992px) {
            .footer-about {
                grid-column: span 1;
            }
        }
        
        @media (max-width: 768px) {
            .footer-container {
                grid-template-columns: 1fr;
            }
            .footer-section h3 {
                margin-bottom: 20px;
            }
            .copyright {
                text-align: left;
                padding: 20px;
            }
        }
    </style>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#165DFF',
                        secondary: '#36D399',
                        accent: '#FF9F43',
                        danger: '#F87272',
                        neutral: {
                            100: '#F5F7FA',
                            200: '#E4E7ED',
                            300: '#C0C6CF',
                            400: '#909399',
                            500: '#606266',
                            600: '#303133',
                            700: '#1E1E1E',
                        }
                    },
                    fontFamily: {
                        inter: ['Inter', 'sans-serif'],
                    },
                    animation: {
                        'bounce-slow': 'bounce 3s infinite',
                        'pulse-slow': 'pulse 4s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                        'float': 'float 6s ease-in-out infinite',
                    },
                    keyframes: {
                        float: {
                            '0%, 100%': {
                                transform: 'translateY(0)'
                            },
                            '50%': {
                                transform: 'translateY(-10px)'
                            },
                        }
                    }
                },
            }
        }
    </script>
    <style type="text/tailwindcss">
        @layer utilities { .content-auto { content-visibility: auto; } .text-balance { text-wrap: balance; } .scrollbar-hide { -ms-overflow-style: none; scrollbar-width: none; } .scrollbar-hide::-webkit-scrollbar { display: none; } .card-shadow { box-shadow:
        0 10px 25px -5px rgba(0, 0, 0, 0.05), 0 8px 10px -6px rgba(0, 0, 0, 0.02); } .card-hover { transition: all 0.3s ease; } .card-hover:hover { transform: translateY(-5px); box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0,
        0, 0, 0.04); } .progress-ring-circle { transition: stroke-dashoffset 0.35s; transform: rotate(-90deg); transform-origin: 50% 50%; } /* ç”¨æˆ·æ æ ·å¼ */ .user-bar { background-color: rgba(255, 255, 255, 0.9); backdrop-filter: blur(10px); padding: 5px 0;
        position: sticky; top: 0; z-index: 100; border-bottom: 1px solid rgba(0,0,0,0.1); } .user-container { display: flex; justify-content: flex-end; align-items: center; padding: 0 20px; gap: 15px; } .user-info { display: flex; align-items: center;
        gap: 8px; } .user-avatar { width: 32px; height: 32px; border-radius: 50%; background-color: #165DFF; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; } .user-btn { padding: 6px 12px; border-radius:
        20px; font-size: 14px; cursor: pointer; transition: all 0.2s ease; height: 28px;} .login-btn { background-color: #165DFF; color: white; border: none; } .login-btn:hover { background-color: #0d5bba; } .logout-btn { background-color: #F5F7FA; color:
        #606266; border: 1px solid #E4E7ED; } .logout-btn:hover { background-color: #e0e0e0; } .delete-btn { background-color: #F87272; color: white; border: none; padding: 4px 8px; border-radius: 4px; font-size: 12px; cursor: pointer; margin-top: 8px;
        } .delete-btn:hover { background-color: #e65c5c; } } @layer utilities { #map-container { position: relative; height: 100%; min-height: 400px; } #activity-container { overflow-y: auto; max-height: 600px; } @media (min-width: 1024px) { #activity-container
        { position: sticky; top: 120px; } } } .like-btn { cursor: pointer; transition: color 0.2s ease; } .like-btn:hover { color: var(--primary); } .like-btn.text-primary { color: #165DFF; } .sticky.top-\[64px\] { top: 64px; position: sticky; z-index:
        40; background-color: rgba(255, 255, 255, 0.9); backdrop-filter: blur(12px); padding-top: 1rem; } @layer utilities { @keyframes emergency-pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.3; } } .animate-emergency { animation: emergency-pulse
        0.8s cubic-bezier(0.4, 0, 0.6, 1) infinite; background-color: #F87272; color: white; border-color: transparent; } @keyframes pulse-fast { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.3); } } .animate-pulse-fast { animation: pulse-fast
        0.5s cubic-bezier(0.4, 0, 0.6, 1) infinite; } } .image-preview { max-height: 200px; object-fit: cover; width: 100%; border-radius: 8px; margin-bottom: 12px; } .location-badge { background-color: #f0f7ff; border: 1px solid #d0e4ff; border-radius:
        16px; padding: 4px 10px; font-size: 0.8rem; display: inline-flex; align-items: center; gap: 4px; margin-bottom: 8px; } #map-container { height: 250px; border-radius: 8px; margin-top: 10px; } @media (max-width: 768px) { #map-container { height:
        200px; } } .image-preview-container { position: relative; display: inline-block; margin-bottom: 12px; } .remove-image-btn { position: absolute; top: 8px; right: 8px; background: rgba(0,0,0,0.6); color: white; border-radius: 50%; width: 24px; height:
        24px; display: flex; align-items: center; justify-content: center; cursor: pointer; z-index: 10; } .filter-btn.active { background-color: #165DFF; color: white; border-color: #165DFF; } @layer utilities { :root { --peace-green: #2ECC71; } .button-peace
        { background-color: var(--peace-green); color: white; } } .hero-section { background-image: url('peace/å’Œå¹³é¸½.jpg'); background-size: cover; background-position: center; position: relative; overflow: hidden; } .hero-overlay { position: absolute;
        top: 0; left: 0; right: 0; bottom: 0; background: linear-gradient(135deg, rgba(22, 93, 255, 0.2) 0%, rgba(54, 211, 153, 0.2) 100%); backdrop-filter: blur(2px); z-index: 0; } .hero-content { position: relative; z-index: 10; text-shadow: 0 2px 10px
        rgba(0, 0, 0, 0.3); } .floating-text { animation: float 6s ease-in-out infinite; } @keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-15px); } } #message-board { background-image: url('peace/é€‰æ‹©ç•™è¨€æ¿èƒŒæ™¯å›¾.png');
        background-size: cover; background-position: right center; background-repeat: no-repeat; position: relative; } #message-board::before { content: ""; position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(255, 255, 255,
        0.7); z-index: 1; } #message-board .container { position: relative; z-index: 2; } @media (max-width: 768px) { #message-board { background-size: auto 100%; background-position: center; } } #message-board { background-attachment: fixed; background-position:
        center; } /* é€šçŸ¥æ ·å¼ */ .notification { position: fixed; top: 20px; right: 20px; background: rgba(41, 128, 185, 0.9); color: white; padding: 15px 25px; border-radius: 8px; box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2); z-index: 1000; animation: slideIn
        0.3s, fadeOut 0.5s 2.5s; } @keyframes slideIn { from { transform: translateX(100px); opacity: 0; } to { transform: translateX(0); opacity: 1; } } @keyframes fadeOut { from { opacity: 1; } to { opacity: 0; } }
    </style>
</head>

<body class="font-inter bg-neutral-100 text-neutral-700 min-h-screen flex flex-col">
    <!-- ç”¨æˆ·ä¿¡æ¯æ  -->
    <div class="user-bar sticky top-0 z-100 border-b border-neutral-200">
        <div class="user-container mx-auto px-4 flex justify-end items-center py-2">

            <div id="user-info" class="flex items-center gap-2">
                <div class="user-info">
                    <a id="profile-link" href="gerenzhongxin_xgawy.html" style="display: none; text-decoration: none; color: inherit;">
                        <div id="user-avatar" class="user-avatar"></div>
                        <span id="username-display"></span>
                    </a>
                </div>
                <button id="login-btn" class="user-btn login-btn">ç™»å½•</button>
                <button id="logout-btn" class="user-btn logout-btn text-sm border border-neutral-300 px-3 py-1.5 rounded-full hover:bg-neutral-50 ml-2" style="display:none">é€€å‡º</button>
            </div>
        </div>
    </div>

    <!-- ä¿®æ”¹åçš„å¯¼èˆªæ  -->
    <header class="sticky top-8 z-50 bg-white/90 backdrop-blur-sm shadow-sm transition-all duration-300">
        <div class="mx-auto px-4 sm:px-6 lg:px-8 max-w-7xl">
            <div class="flex flex-col md:flex-row justify-between items-center py-4">
                <div class="flex items-center mb-4 md:mb-0">
                    <a href="#" class="flex items-center space-x-2">
                        <div class="w-10 h-10 rounded-lg bg-primary flex items-center justify-center text-white">
                            <img src="peace/å’Œå¹³çº½å¸¦.png" alt="å’Œå¹³çº½å¸¦å›¾æ ‡" class="h-full w-full object-cover">
                        </div>
                        <span class="text-xl font-bold text-neutral-700">å’Œå¹³çº½å¸¦</span>
                    </a>
                </div>

                <nav class="hidden md:flex items-center space-x-6">
                    <a href="shouye2.0_xgawy.html" class="px-4 py-2 rounded-lg text-neutral-600 hover:bg-primary/10 hover:text-primary transition-colors font-medium">è¿”å›é¦–é¡µ</a>
                    <a href="#action-map" class="px-4 py-2 rounded-lg text-neutral-600 hover:bg-primary/10 hover:text-primary transition-colors font-medium">è¡ŒåŠ¨åœ°å›¾</a>
                    <a href="#message-board" class="px-4 py-2 rounded-lg text-neutral-600 hover:bg-primary/10 hover:text-primary transition-colors font-medium">ç•™è¨€æ¿</a>
                    <a href="#toolkits" class="px-4 py-2 rounded-lg text-neutral-600 hover:bg-primary/10 hover:text-primary transition-colors font-medium">å·¥å…·åŒ…</a>
                    <a href="#peace-tree" class="px-4 py-2 rounded-lg text-neutral-600 hover:bg-primary/10 hover:text-primary transition-colors font-medium">å’Œå¹³ä¹‹æ ‘</a>
                    <a href="#footer" class="px-4 py-2 rounded-lg text-neutral-600 hover:bg-primary/10 hover:text-primary transition-colors font-medium">å…³äºæˆ‘ä»¬</a>
                    <button id="nav-login-btn" class="px-4 py-2 rounded-lg bg-primary text-white font-medium hover:bg-primary/90 transition-colors">ç™»å½•</button>
                </nav>

                <button class="md:hidden text-neutral-600" id="mobile-menu-button">
                    <i class="fa fa-bars text-xl"></i>
                </button>
            </div>
        </div>

        <div class="md:hidden hidden bg-white border-t" id="mobile-menu">
            <div class="container mx-auto px-4 py-3 space-y-2">
                <a href="shouye2.0_xgawy.html" class="block px-4 py-3 rounded-lg text-neutral-600 hover:bg-primary/10 hover:text-primary transition-colors font-medium">è¿”å›é¦–é¡µ</a>
                <a href="#action-map" class="block px-4 py-3 rounded-lg text-neutral-600 hover:bg-primary/10 hover:text-primary transition-colors font-medium">è¡ŒåŠ¨åœ°å›¾</a>
                <a href="#message-board" class="block px-4 py-3 rounded-lg text-neutral-600 hover:bg-primary/10 hover:text-primary transition-colors font-medium">ç•™è¨€æ¿</a>
                <a href="#toolkits" class="block px-4 py-3 rounded-lg text-neutral-600 hover:bg-primary/10 hover:text-primary transition-colors font-medium">å·¥å…·åŒ…</a>
                <a href="#peace-tree" class="block px-4-py-3 rounded-lg text-neutral-600 hover:bg-primary/10 hover:text-primary transition-colors font-medium">å’Œå¹³ä¹‹æ ‘</a>
                <a href="guanyuwomen_xgawy.html" class="block px-4 py-3 rounded-lg text-neutral-600 hover:bg-primary/10 hover:text-primary transition-colors font-medium">å…³äºæˆ‘ä»¬</a>
                <button id="mobile-login-btn" class="block w-full px-4 py-3 rounded-lg bg-primary text-white font-medium hover:bg-primary/90 transition-colors">ç™»å½•</button>
            </div>
        </div>
    </header>
    <main class="flex-grow">
        <!-- è‹±é›„åŒºåŸŸ -->
        <section class="hero-section py-16 md:py-24">
            <div class="hero-overlay"></div>
            <div class="container mx-auto px-4 sm:px-6 lg:px-8">
                <div class="max-w-3xl mx-auto text-center hero-content">
                    <h1 class="text-[clamp(2rem,5vw,3.5rem)] font-bold text-white leading-tight mb-6 floating-text">
                        è¿æ¥è¡ŒåŠ¨ï¼Œ<span class="text-yellow-300">ä¼ é€’å’Œå¹³</span>
                    </h1>
                    <p class="text-[clamp(1rem,2vw,1.25rem)] text-white mb-8 text-balance">
                        åŠ å…¥å…¨çƒè¡ŒåŠ¨ç¤¾åŒºï¼Œå‘ç°é™„è¿‘çš„å’Œå¹³æ´»åŠ¨ï¼Œåˆ†äº«ä½ çš„æƒ³æ³•ä¸æ„¿æ™¯ï¼Œå…±åŒåˆ›é€ æ›´ç¾å¥½çš„ä¸–ç•Œ
                    </p>
                    <div class="flex justify-center">
                        <button class="bg-primary hover:bg-primary/90 text-white font-medium px-8 py-3 rounded-full shadow-lg transform transition-all hover:scale-105">
                            <a href="#about-us">åŠ å…¥æˆ‘ä»¬</a>
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <!-- è¡ŒåŠ¨åŒºåŸŸæ¨¡å—ï¼ˆæ›¿æ¢ä¸ºæ—§é¡µé¢ç‰ˆæœ¬ï¼‰ -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <!-- å·¦ä¾§ï¼šåœ°å›¾åŒºåŸŸ -->
            <div class="lg:col-span-2 bg-white rounded-xl overflow-hidden shadow-xl" id="action-map">
                <div class="px-6 pt-6">
                    <h2 class="text-2xl font-bold text-neutral-700 mb-4">è¡ŒåŠ¨åŒºåŸŸ</h2>
                </div>
                <div id="map" class="h-[400px] md:h-[600px] rounded-xl z-0"></div>
            </div>

            <!-- å³ä¾§ï¼šæ´»åŠ¨å†…å®¹åŒºåŸŸ -->
            <div class="lg:col-span-1" id="activity-container">
                <!-- æ´»åŠ¨å†…å®¹å°†é€šè¿‡JSåŠ¨æ€åŠ è½½ -->
                <div class="bg-white rounded-xl shadow-lg p-6 h-full" id="empty-state">
                    <div class="flex flex-col items-center justify-center h-full">
                        <i class="fa fa-map-o text-5xl text-neutral-300 mb-4"></i>
                        <h3 class="text-xl font-medium text-neutral-700 mb-2">é€‰æ‹©è¡ŒåŠ¨ç±»å‹</h3>
                        <p class="text-neutral-500 text-center">ç‚¹å‡»åœ°å›¾ä¸Šçš„æ ‡è®°ç‚¹æˆ–ä¸Šæ–¹æ ‡ç­¾ç­›é€‰æ´»åŠ¨ï¼Œå³ä¾§å°†æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- è¡ŒåŠ¨åˆ†ç±»æ ‡ç­¾åŒº - ä¿®æ”¹åç‰ˆæœ¬ -->
        <section>
            <div class="container mx-auto px-4 sm:px-6 lg:px-8">
                <!-- æ–°å¢æ—¶é—´æ»‘å—ï¼ˆå›ºå®šåœ¨åˆ†ç±»æ ‡ç­¾ä¸Šæ–¹ï¼‰ -->
                <div class="mb-4 bg-white/80 backdrop-blur-sm p-3 rounded-lg shadow-sm border border-neutral-200">
                    <div class="flex justify-between items-center mb-1">
                        <span class="text-sm font-medium text-neutral-600">æ´»åŠ¨æ—¶é—´èŒƒå›´ï¼š</span>
                        <span id="time-slider-value" class="text-sm font-medium text-primary">æœªæ¥30å¤©</span>
                    </div>
                    <input type="range" min="7" max="180" value="30" class="w-full h-2 bg-neutral-200 rounded-lg appearance-none cursor-pointer" id="time-slider">
                </div>

                <!-- åŸæœ‰çš„è¡ŒåŠ¨åˆ†ç±»æ ‡ç­¾ -->
                <div class="flex flex-wrap justify-center gap-4" id="action-tags">
                    <a href="#" class="action-tag px-6 py-3 rounded-full bg-primary text-white font-medium" data-action="online">
                        çº¿ä¸Šè¡ŒåŠ¨
                    </a>
                    <a href="#" class="action-tag px-6 py-3 rounded-full bg-white text-neutral-600 border border-neutral-200 font-medium hover:bg-neutral-50 transition-colors" data-action="offline">
                        çº¿ä¸‹è¡ŒåŠ¨
                    </a>
                    <a href="#" class="action-tag px-6 py-3 rounded-full bg-white text-neutral-600 border border-neutral-200 font-medium hover:bg-neutral-50 transition-colors" data-action="education">
                        æ•™è‚²è¡ŒåŠ¨
                    </a>
                    <a href="#" class="action-tag px-6 py-3 rounded-full bg-white text-neutral-600 border border-neutral-200 font-medium hover:bg-neutral-50 transition-colors animate-emergency" data-action="emergency">
                        ç´§æ€¥å“åº” <i class="fa fa-exclamation-triangle text-danger ml-1 animate-pulse-fast"></i>
                    </a>
                </div>
            </div>
        </section>

        <!-- ç•™è¨€æ¿åŒºåŸŸ -->
        <section id="message-board" class="py-16 md:py-24 bg-neutral-50 relative">
            <div class="container mx-auto px-4 sm:px-6 lg:px-8 relative z-2">
                <div class="text-center mb-12">
                    <h2 class="text-[clamp(1.5rem,3vw,2.5rem)] font-bold text-neutral-700 mb-4">å’Œå¹³å®£è¨€ç•™è¨€æ¿</h2>
                    <p class="text-neutral-500 max-w-2xl mx-auto">åˆ†äº«ä½ çš„å’Œå¹³æ„¿æ™¯ã€è¡ŒåŠ¨æ•…äº‹æˆ–æ„Ÿæ‚Ÿæ€è€ƒï¼Œè®©æ›´å¤šäººå¬åˆ°ä½ çš„å£°éŸ³</p>
                </div>
                <!-- åˆ›ä½œé¢æ¿ -->
                <div class="bg-white rounded-2xl shadow-xl p-6 md:p-8 mb-12">
                    <h3 class="text-xl font-bold text-neutral-700 mb-6">å‘è¡¨ä½ çš„å®£è¨€</h3>
                    <div class="space-y-6">
                        <!-- å¿ƒæƒ…é€‰æ‹© -->
                        <div>
                            <label class="block text-sm font-medium text-neutral-600 mb-2">é€‰æ‹©ä½ çš„å¿ƒæƒ…</label>
                            <div class="flex space-x-4">
                                <button class="emotion-btn w-10 h-10 rounded-full bg-neutral-100 flex items-center justify-center text-2xl hover:bg-primary/10 hover:text-primary transition-colors" data-emotion="sad">
                                    ğŸ˜¢
                                </button>
                                <button class="emotion-btn w-10 h-10 rounded-full bg-neutral-100 flex items-center justify-center text-2xl hover:bg-primary/10 hover:text-primary transition-colors" data-emotion="angry">
                                    ğŸ˜ 
                                </button>
                                <button class="emotion-btn w-10 h-10 rounded-full bg-neutral-100 flex items-center justify-center text-2xl hover:bg-primary/10 hover:text-primary transition-colors" data-emotion="happy">
                                    âœŒ
                                </button>
                                <button class="emotion-btn w-10 h-10 rounded-full bg-neutral-100 flex items-center justify-center text-2xl hover:bg-primary/10 hover:text-primary transition-colors" data-emotion="love">
                                    â¤
                                </button>
                            </div>
                        </div>
                        <!-- ä¿®æ”¹æ–‡æœ¬è¾“å…¥åŒºåŸŸçš„å­—ç¬¦è®¡æ•°åŠŸèƒ½ -->
                        <div>
                            <label for="message-text" class="block text-sm font-medium text-neutral-600 mb-2">ä½ çš„å®£è¨€
                                (æœ€å¤š280å­—ç¬¦)</label>
                            <textarea id="message-text" rows="4" maxlength="280" class="w-full px-4 py-3 rounded-lg border border-neutral-300 focus:ring-2 focus:ring-primary focus:border-primary transition-all resize-none" placeholder="åˆ†äº«ä½ çš„å’Œå¹³æ„¿æ™¯ã€è¡ŒåŠ¨æ•…äº‹æˆ–æ„Ÿæ‚Ÿæ€è€ƒ..."></textarea>
                            <p id="char-count" class="text-sm text-neutral-500 mt-1">0/280 å­—ç¬¦</p>
                        </div>

                        <!-- å›¾ç‰‡é¢„è§ˆåŒºåŸŸ -->
                        <div id="image-preview-container" class="hidden">
                            <div class="image-preview-container">
                                <img id="image-preview" class="image-preview" src="" alt="å›¾ç‰‡é¢„è§ˆ">
                                <div class="remove-image-btn" id="remove-image">
                                    <i class="fa fa-times text-xs"></i>
                                </div>
                            </div>
                        </div>

                        <!-- ä½ç½®é€‰æ‹©åŒºåŸŸ -->
                        <div>
                            <label class="block text-sm font-medium text-neutral-600 mb-2">é€‰æ‹©ä½ç½®</label>
                            <div class="flex flex-wrap gap-4">
                                <div class="flex items-center space-x-2 px-4 py-3 rounded-lg border border-neutral-300 hover:border-primary cursor-pointer transition-colors">
                                    <input type="radio" name="location" id="location-global" class="hidden" value="å…¨çƒ">
                                    <label for="location-global" class="cursor-pointer flex items-center">
                                        <i class="fa fa-globe text-neutral-400 text-xl mr-2"></i>
                                        <span class="text-neutral-600">å…¨çƒ</span>
                                    </label>
                                </div>
                                <div class="flex items-center space-x-2 px-4 py-3 rounded-lg border border-neutral-300 hover:border-primary cursor-pointer transition-colors">
                                    <input type="radio" name="location" id="location-asia" class="hidden" value="äºšæ´²">
                                    <label for="location-asia" class="cursor-pointer flex items-center">
                                        <i class="fa fa-map-marker text-neutral-400 text-xl mr-2"></i>
                                        <span class="text-neutral-600">äºšæ´²</span>
                                    </label>
                                </div>
                                <div class="flex items-center space-x-2 px-4 py-3 rounded-lg border border-neutral-300 hover:border-primary cursor-pointer transition-colors">
                                    <input type="radio" name="location" id="location-europe" class="hidden" value="æ¬§æ´²">
                                    <label for="location-europe" class="cursor-pointer flex items-center">
                                        <i class="fa fa-map-marker text-neutral-400 text-xl mr-2"></i>
                                        <span class="text-neutral-600">æ¬§æ´²</span>
                                    </label>
                                </div>
                                <div class="flex items-center space-x-2 px-4 py-3 rounded-lg border border-neutral-300 hover:border-primary cursor-pointer transition-colors">
                                    <input type="radio" name="location" id="location-na" class="hidden" value="åŒ—ç¾">
                                    <label for="location-na" class="cursor-pointer flex items-center">
                                        <i class="fa fa-map-marker text-neutral-400 text-xl mr-2"></i>
                                        <span class="text-neutral-600">åŒ—ç¾</span>
                                    </label>
                                </div>
                            </div>
                        </div>

                        <!-- é™„åŠ åŠŸèƒ½ -->
                        <div class="flex flex-wrap gap-4">
                            <label class="flex items-center space-x-2 px-4 py-3 rounded-lg border-2 border-dashed border-neutral-300 hover:border-primary cursor-pointer transition-colors">
                                <input type="file" accept="image/*" class="hidden" id="message-image">
                                <i class="fa fa-image text-neutral-400 text-xl"></i>
                                <span class="text-neutral-600">æ·»åŠ ç…§ç‰‡</span>
                            </label>
                            <button id="post-message" class="ml-auto px-6 py-3 rounded-lg bg-primary text-white font-medium hover:bg-primary/90 transition-colors shadow-md hover:shadow-lg">
                                å‘è¡¨å®£è¨€
                            </button>
                        </div>
                    </div>
                </div>

                <!-- å®£è¨€å¡ç‰‡åŒºåŸŸ -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="message-feed">
                    <!-- å®£è¨€å¡ç‰‡ 1 (å›¾æ–‡) -->
                    <div class="message-card bg-white rounded-xl overflow-hidden shadow-lg card-hover" data-emotion="love" data-location="äºšæ´²">
                        <div class="relative">
                            <img src="https://picsum.photos/id/1067/600/400" alt="å’Œå¹³æŠ—è®®æ´»åŠ¨" class="w-full h-48 object-cover">
                            <div class="absolute top-3 left-3">
                                <span class="px-2 py-1 rounded-full bg-love/90 text-white text-xs font-medium">â¤
                                    çˆ±</span>
                            </div>
                        </div>
                        <div class="p-5">
                            <h4 class="font-semibold text-neutral-700 mb-2">æˆ‘ä»¬ä¸€èµ·åˆ›é€ å’Œå¹³</h4>
                            <p class="text-neutral-500 text-sm mb-4">
                                ä¸Šå‘¨å‚åŠ äº†ç¤¾åŒºå’Œå¹³æ¸¸è¡Œï¼Œçœ‹åˆ°ä¸åŒå¹´é¾„ã€ä¸åŒèƒŒæ™¯çš„äººèµ°åˆ°ä¸€èµ·ï¼Œè®©æˆ‘ç›¸ä¿¡æ”¹å˜æ˜¯å¯èƒ½çš„ã€‚å’Œå¹³ä¸æ˜¯è¢«åŠ¨ç­‰å¾…ï¼Œè€Œæ˜¯ä¸»åŠ¨åˆ›é€ ã€‚</p>
                            <div class="location-badge mb-3">
                                <i class="fa fa-map-marker text-primary"></i>
                                <span>äºšæ´²</span>
                            </div>
                            <div class="flex items-center justify-between">
                                <div class="flex items-center space-x-1">
                                    <img src="https://picsum.photos/id/1027/40/40" alt="ç”¨æˆ·å¤´åƒ" class="w-8 h-8 rounded-full">
                                    <span class="text-xs text-neutral-500">ææ˜ Â· 2å¤©å‰</span>
                                </div>
                                <div class="flex space-x-4">
                                    <button class="text-neutral-400 hover:text-primary transition-colors like-btn" data-message-id="1" data-likes="42">
                                        <i class="fa fa-thumbs-up mr-1"></i> <span class="like-count">42</span>
                                    </button>
                                    <button class="text-neutral-400 hover:text-primary transition-colors">
                                        <i class="fa fa-comment mr-1"></i> 8
                                    </button>
                                    <button class="text-neutral-400 hover:text-primary transition-colors">
                                        <i class="fa fa-share-alt"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- å®£è¨€å¡ç‰‡ 2 (çº¯æ–‡æœ¬) -->
                    <div class="message-card bg-white rounded-xl overflow-hidden shadow-lg card-hover" data-emotion="happy" data-location="æ¬§æ´²">
                        <div class="p-5 relative">
                            <div class="absolute top-3 left-3">
                                <span class="px-2 py-1 rounded-full bg-happy/90 text-white text-xs font-medium">âœŒ
                                    å¸Œæœ›</span>
                            </div>
                            <h4 class="font-semibold text-neutral-700 mb-2">å’Œå¹³æ•™è‚²ä»å®¶åº­å¼€å§‹</h4>
                            <p class="text-neutral-500 text-sm mb-4">
                                ä½œä¸ºä¸€åæ•™å¸ˆï¼Œæˆ‘ç›¸ä¿¡å’Œå¹³æ•™è‚²è¦ä»å®¶åº­å’Œå­¦æ ¡å¼€å§‹ã€‚æˆ‘ä»¬åº”è¯¥æ•™å¯¼å­©å­ä»¬å¦‚ä½•ç”¨éæš´åŠ›æ–¹å¼è§£å†³å†²çªï¼ŒåŸ¹å…»åŒç†å¿ƒå’Œç†è§£ä»–äººçš„èƒ½åŠ›ã€‚è¿™æ˜¯åˆ›é€ å’Œå¹³ç¤¾ä¼šçš„åŸºç¡€ã€‚</p>
                            <div class="location-badge mb-3">
                                <i class="fa fa-map-marker text-primary"></i>
                                <span>æ¬§æ´²</span>
                            </div>
                            <div class="flex items-center justify-between">
                                <div class="flex items-center space-x-1">
                                    <img src="https://picsum.photos/id/1012/40/40" alt="ç”¨æˆ·å¤´åƒ" class="w-8 h-8 rounded-full">
                                    <span class="text-xs text-neutral-500">ç‹èŠ³ Â· 3å¤©å‰</span>
                                </div>
                                <div class="flex space-x-4">
                                    <button class="text-neutral-400 hover:text-primary transition-colors like-btn" data-message-id="2" data-likes="28">
                                        <i class="fa fa-thumbs-up mr-1"></i> <span class="like-count">28</span>
                                    </button>
                                    <button class="text-neutral-400 hover:text-primary transition-colors">
                                        <i class="fa fa-comment mr-1"></i> 5
                                    </button>
                                    <button class="text-neutral-400 hover:text-primary transition-colors">
                                        <i class="fa fa-share-alt"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- å®£è¨€å¡ç‰‡ 3 (å›¾æ–‡) -->
                    <div class="message-card bg-white rounded-xl overflow-hidden shadow-lg card-hover" data-emotion="angry" data-location="åŒ—ç¾">
                        <div class="relative">
                            <img src="https://picsum.photos/id/1033/600/400" alt="ç¯å¢ƒæ±¡æŸ“" class="w-full h-48 object-cover">
                            <div class="absolute top-3 left-3">
                                <span class="px-2 py-1 rounded-full bg-angry/90 text-white text-xs font-medium">ğŸ˜ 
                                    æ„¤æ€’</span>
                            </div>
                        </div>
                        <div class="p-5">
                            <h4 class="font-semibold text-neutral-700 mb-2">æˆ‘ä»¬ä¸èƒ½å†å¯¹ç¯å¢ƒé—®é¢˜è§†è€Œä¸è§</h4>
                            <p class="text-neutral-500 text-sm mb-4">
                                çœ‹åˆ°æˆ‘ä»¬çš„åœ°çƒé­å—å¦‚æ­¤ä¸¥é‡çš„ç ´åï¼Œæˆ‘æ„Ÿåˆ°éå¸¸æ„¤æ€’ã€‚æ°”å€™å˜åŒ–ã€æ±¡æŸ“å’Œç”Ÿç‰©å¤šæ ·æ€§ä¸§å¤±æ­£åœ¨å¨èƒç€æˆ‘ä»¬çš„æœªæ¥ã€‚æˆ‘ä»¬å¿…é¡»é‡‡å–è¡ŒåŠ¨ï¼Œä¿æŠ¤æˆ‘ä»¬å…±åŒçš„å®¶å›­ã€‚</p>
                            <div class="location-badge mb-3">
                                <i class="fa fa-map-marker text-primary"></i>
                                <span>åŒ—ç¾</span>
                            </div>
                            <div class="flex items-center justify-between">
                                <div class="flex items-center space-x-1">
                                    <img src="https://picsum.photos/id/1005/40/40" alt="ç”¨æˆ·å¤´åƒ" class="w-8 h-8 rounded-full">
                                    <span class="text-xs text-neutral-500">å¼ ä¼Ÿ Â· 5å¤©å‰</span>
                                </div>
                                <div class="flex space-x-4">
                                    <button class="text-neutral-400 hover:text-primary transition-colors like-btn" data-message-id="3" data-likes="67">
                                        <i class="fa fa-thumbs-up mr-1"></i> <span class="like-count">67</span>
                                    </button>
                                    <button class="text-neutral-400 hover:text-primary transition-colors">
                                        <i class="fa fa-comment mr-1"></i> 12
                                    </button>
                                    <button class="text-neutral-400 hover:text-primary transition-colors">
                                        <i class="fa fa-share-alt"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
        </section>
    </main>

    <!-- å’Œå¹³ä¹‹æ ‘ç‰¹åˆ«ä¼åˆ’åŒº -->
    <section class="py-16 bg-gradient-to-b from-secondary/10 to-primary/10" id="peace-tree">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-12">
                <h2 class="text-[clamp(1.8rem,4vw,2.8rem)] font-bold text-neutral-700 mb-4">å’Œå¹³ä¹‹æ ‘</h2>
                <p class="text-neutral-500 max-w-3xl mx-auto">æ¯ä¸€ç‰‡å¶å­éƒ½ä»£è¡¨ä¸€ä¸ªå’Œå¹³å®£è¨€ï¼Œè®©æˆ‘ä»¬å…±åŒåŸ¹è‚²è¿™æ£µè±¡å¾å’Œå¹³çš„æ ‘</p>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 items-center">
                <!-- æ ‘å½¢å¯è§†åŒ–åŒºåŸŸ - ä¿®æ”¹ä¸ºå¹³è§†æ•ˆæœ -->
                <div class="relative h-96 flex justify-center">
                    <!-- æ ‘å¹² -->
                    <div class="absolute bottom-0 w-8 h-64 bg-amber-800 rounded-t-lg"></div>

                    <!-- æ ‘å†  - æ”¹ä¸ºå¹³è§†æ•ˆæœçš„æ¤­åœ† -->
                    <div class="absolute bottom-32 w-64 h-32 bg-green-600 rounded-full"></div>
                    <div class="absolute bottom-48 w-80 h-40 bg-green-500 rounded-full"></div>
                    <div class="absolute bottom-64 w-56 h-32 bg-green-400 rounded-full"></div>

                    <div id="tree-leaves" class="absolute w-full h-full">
                        <!-- æ ‘å¶å°†é€šè¿‡JSåŠ¨æ€æ·»åŠ  -->
                    </div>
                </div>

                <!-- å®£è¨€ç”Ÿæˆè¡¨å• -->
                <div class="bg-white rounded-2xl shadow-xl p-6 md:p-8">
                    <h3 class="text-xl font-bold text-neutral-700 mb-6">ä¸ºå’Œå¹³ä¹‹æ ‘æ·»åŠ ä½ çš„å¶å­</h3>
                    <div class="space-y-6">
                        <div>
                            <label for="tree-message" class="block text-sm font-medium text-neutral-600 mb-2">ä½ çš„å’Œå¹³å®£è¨€</label>
                            <textarea id="tree-message" rows="3" class="w-full px-4 py-3 rounded-lg border border-neutral-300 focus:ring-2 focus:ring-primary focus:border-primary transition-all resize-none" placeholder="å†™ä¸‹ä½ çš„å’Œå¹³æ„¿æœ›..."></textarea>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-neutral-600 mb-2">å¶å­é¢œè‰²</label>
                            <div class="flex flex-wrap gap-3">
                                <button class="leaf-color w-8 h-8 rounded-full bg-green-500 border-2 border-transparent hover:border-neutral-300 transition-all" data-color="green-500"></button>
                                <button class="leaf-color w-8 h-8 rounded-full bg-green-600 border-2 border-transparent hover:border-neutral-300 transition-all" data-color="green-600"></button>
                                <button class="leaf-color w-8 h-8 rounded-full bg-yellow-400 border-2 border-transparent hover:border-neutral-300 transition-all" data-color="yellow-400"></button>
                                <button class="leaf-color w-8 h-8 rounded-full bg-red-400 border-2 border-transparent hover:border-neutral-300 transition-all" data-color="red-400"></button>
                                <button class="leaf-color w-8 h-8 rounded-full bg-orange-400 border-2 border-transparent hover:border-neutral-300 transition-all" data-color="orange-400"></button>
                            </div>
                        </div>
                        <button id="add-leaf" class="w-full px-6 py-3 rounded-lg bg-primary text-white font-medium hover:bg-primary/90 transition-colors shadow-md hover:shadow-lg">
                            ç”Ÿæˆå’Œå¹³ä¹‹å¶
                        </button>
                    </div>

                    <!-- å®£è¨€ç»Ÿè®¡ -->
                    <div class="mt-8 pt-6 border-t border-neutral-200">
                        <div class="grid grid-cols-3 gap-4 text-center">
                            <div>
                                <div id="total-leaves" class="text-2xl font-bold text-primary">1,248</div>
                                <div class="text-sm text-neutral-500">æ€»å¶å­æ•°</div>
                            </div>
                            <div>
                                <div class="text-2xl font-bold text-accent">42</div>
                                <div class="text-sm text-neutral-500">å›½å®¶åœ°åŒº</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section id="toolkits" class="py-16 md:py-24 relative min-h-[400px] flex flex-col justify-center items-center 
                       bg-cover bg-center bg-no-repeat" style="background-image: url('peace/è¡ŒåŠ¨å·¥å…·åŒ….png'); background-attachment: fixed;">
        <div class="relative z-10 w-full max-w-3xl px-4 text-center">
            <h2 class="text-3xl md:text-4xl font-bold text-white mb-4">è¡ŒåŠ¨å·¥å…·åŒ…</h2>
            <p class="text-white text-lg md:text-xl mb-8">ä¸‹è½½å®ç”¨èµ„æºï¼Œå¸®åŠ©ä½ æ›´æœ‰æ•ˆåœ°ç»„ç»‡å’Œå‚ä¸å’Œå¹³è¡ŒåŠ¨</p>
            <div class="flex flex-wrap justify-center gap-4">
                <button class="download-btn flex items-center space-x-2 px-5 py-2.5 rounded-lg bg-white text-blue-600 
                       shadow-md hover:shadow-lg transition-all cursor-pointer" data-resource="protest-poster">
                    <i class="fa fa-file-image-o text-xl"></i>
                    <span class="text-base md:text-lg">æŠ—è®®æµ·æŠ¥æ¨¡æ¿</span>
                </button>
                <button class="download-btn flex items-center space-x-2 px-5 py-2.5 rounded-lg bg-white text-blue-600 
                       shadow-md hover:shadow-lg transition-all cursor-pointer" data-resource="community-guide">
                    <i class="fa fa-book text-xl"></i>
                    <span class="text-base md:text-lg">ç¤¾åŒºè¡ŒåŠ¨æŒ‡å—</span>
                </button>
                <button class="download-btn flex items-center space-x-2 px-5 py-2.5 rounded-lg bg-white text-blue-600 
                       shadow-md hover:shadow-lg transition-all cursor-pointer" data-resource="promotion-example">
                    <i class="fa fa-file-text-o text-xl"></i>
                    <span class="text-base md:text-lg">å®£ä¼ æ–‡æ¡ˆèŒƒä¾‹</span>
                </button>
            </div>
        </div>
    </section>
    <!-- åº•éƒ¨å›ºå®šæ ‡ç­¾ -->
    <div class="fixed bottom-4 right-4 z-40">
        <div class="flex flex-col space-y-2">
            <a href="#top" class="bg-blue-500 hover:bg-blue-600 text-white w-12 h-12 rounded-full flex items-center justify-center shadow-lg transition-all duration-300">
                <i class="fa fa-arrow-up"></i>
            </a>
        </div>
    </div>
    <!-- é¡µè„š -->
    <footer class="footer">
        <div class="footer-container" id="footer">
            <div class="footer-section">
                <h3 id="footer-about-us">å…³äºæˆ‘ä»¬</h3>
                <p id="footer-about-text">
                    å’Œå¹³è¡ŒåŠ¨æ˜¯ä¸€ä¸ªå›½é™…æ€§éè¥åˆ©ç»„ç»‡ï¼Œè‡´åŠ›äºé€šè¿‡æ•™è‚²ã€å€¡å¯¼å’Œäººé“ä¸»ä¹‰è¡ŒåŠ¨æ¶ˆé™¤æˆ˜äº‰ï¼Œä¿ƒè¿›å…¨çƒå’Œå¹³ã€‚æˆ‘ä»¬çš„ä½¿å‘½æ˜¯åˆ›é€ ä¸€ä¸ªæ²¡æœ‰æˆ˜äº‰çš„ä¸–ç•Œï¼Œè®©æ¯ä¸ªäººéƒ½èƒ½åœ¨å’Œå¹³ä¸å®‰å…¨ä¸­ç”Ÿæ´»ã€‚</p>

            </div>

            <div class="footer-section">
                <h3 id="footer-links">å¿«é€Ÿé“¾æ¥</h3>
                <ul class="footer-links">
                    <li><a href="shouye2.0_xgawy.html"><i class="fa fa-chevron-right"></i> <span data-key="footer-home">é¦–é¡µ</span></a></li>
                    <li><a href="guanyuwomen_xgawy.html"><i class="fa fa-chevron-right"></i> <span data-key="footer-about">å…³äºæˆ‘ä»¬</span></a>
                    </li>
                    <li><a href="biaozhi_xgawy.html"><i class="fa fa-chevron-right"></i> <span data-key="footer-logo">æ ‡å¿—</span></a></li>
                    <li><a href="https://www.crcf.org.cn/web/woyaojuanzeng/woyaojuanzeng.thtml?classFlag=donate"><i class="fa fa-chevron-right"></i> <span data-key="footer-donate">ææ¬¾</span></a>
                    </li>
                    <li><a href="shouye2.0_xgawy.html#war-peace-theme"><i class="fa fa-chevron-right"></i> <span
                                    data-key="footer-war-peace">æˆ˜äº‰ä¸å’Œå¹³</span></a></li>
                    <li><a href="huodong_xgawy.html"><i class="fa fa-chevron-right"></i> <span data-key="footer-events">æ´»åŠ¨</span></a>
                    </li>
                </ul>
            </div>

            <div class="footer-section">
                <h3 id="footer-contact">è”ç³»æˆ‘ä»¬</h3>
                <ul class="contact-info">
                    <li>

                        <div data-key="footer-email">é‚®ç®±: 16666666@outlook.com<br></div>
                    </li>
                    <li>

                        <div data-key="footer-phone">ç”µè¯:12345678910ä¸¾æŠ¥çƒ­çº¿:110</div>
                    </li>
                    <li>

                        <div data-key="footer-address">åœ°å€: æµ™æ±Ÿçœæ­å·å¸‚æ»¨æ±ŸåŒº<br></div>
                    </li>
                    <li>

                        <div data-key="footer-wechat">å¾®ä¿¡:lllllll </div>
                    </li>
                </ul>
            </div>
            <div class="footer-section">
                <h3 id="footer-friend-links">å‹æƒ…é“¾æ¥</h3>
                <div class="friend-links">
                    <a href="https://www.unesco.org/zh" target="_blank"><i class="fa fa-link"></i> <span data-key="footer-unesco">è”åˆå›½æ•™ç§‘æ–‡ç»„ç»‡</span></a>
                    <a href="https://www.icrc.org" target="_blank"><i class="fa fa-link"></i> <span data-key="footer-red-cross">å›½é™…çº¢åå­—ä¼š</span></a>
                    <a href="https://www.tufts.edu/wpf" target="_blank"><i class="fa fa-link"></i> <span data-key="footer-peace-foundation">ä¸–ç•Œå’Œå¹³åŸºé‡‘ä¼š</span></a>
                    <a href="https://www.unocha.org" target="_blank"><i class="fa fa-link"></i> <span data-key="footer-aid-network">äººé“ä¸»ä¹‰æ´åŠ©ç½‘</span></a>
                    <a href="https://baike.baidu.com/item/%E5%8F%8D%E6%B3%95%E8%A5%BF%E6%96%AF%E5%90%8C%E7%9B%9F/7459883#:~:text=%E7%AC%AC%E4%BA%8C%E6%AC%A1%E4%B8%96%E7%95%8C%E5%A4%A7%E6%88%98%E4%B8%AD%E7%9A%84%E5%86%9B%E4%BA%8B%E5%90%8C%E7%9B%9F%E5%8F%8D%E6%B3%95%E8%A5%BF%E6%96%AF%E5%90%8C%E7%9B%9F(Anti%20fascist%20Alliance)%EF%BC%8C1942%E5%B9%B41%E6%9C%881%E6%97%A5%EF%BC%8C%E8%8B%B1%E7%BE%8E%E8%8B%8F%E4%B8%AD%E7%AD%8926%E4%B8%AA%E5%9B%BD%E5%AE%B6%E5%9C%A8%E5%8D%8E%E7%9B%9B%E9%A1%BF%E4%B8%BE%E8%A1%8C%E4%BC%9A%E8%AE%AE%EF%BC%8C%E7%AD%BE%E7%BD%B2%E4%BA%86%E3%80%8A%E8%81%94%E5%90%88%E5%9B%BD%E5%AE%B6%E5%AE%A3%E8%A8%80%E3%80%8B%EF%BC%8C%E6%A0%87%E5%BF%97%E7%9D%80%E5%9B%BD%E9%99%85%E5%8F%8D%E6%B3%95%E8%A5%BF%E6%96%AF%E7%BB%9F%E4%B8%80%E6%88%98%E7%BA%BF%E6%9C%80%E7%BB%88%E5%BD%A2%E6%88%90%E3%80%82%E5%8F%8D%E6%B3%95%E8%A5%BF%E6%96%AF%E8%81%94%E7%9B%9F%E7%9A%84%E5%BB%BA%E7%AB%8B%E4%BD%BF%E7%AC%AC%E4%BA%8C%E6%AC%A1%E4%B8%96%E7%95%8C%E5%A4%A7%E6%88%98%E7%9A%84%E5%BD%A2%E5%8A%BF%E5%8F%91%E7%94%9F%E5%8F%98%E5%8C%96%EF%BC%8C%E6%98%AF%E5%8F%8D%E6%B3%95%E8%A5%BF%E6%96%AF%E6%88%98%E4%BA%89%E5%8F%96%E5%BE%97%E6%9C%80%E5%90%8E%E8%83%9C%E5%88%A9%E7%9A%84%E5%86%B3%E5%AE%9A%E6%80%A7%E5%9B%A0%E7%B4%A0%E4%B9%8B%E4%B8%80%EF%BC%8C%E5%B9%B6%E4%B8%BA%E8%81%94%E5%90%88%E5%9B%BD%E7%9A%84%E6%88%90%E7%AB%8B%E5%A5%A0%E5%AE%9A%E4%BA%86%E5%9F%BA%E7%A1%80%E3%80%82"
                        target="_blank"><i class="fa fa-link"></i> <span data-key="footer-anti-war">å…¨çƒåæˆ˜è”ç›Ÿ</span></a>
                    <a href="https://www.tc.edu/peace-ed" target="_blank"><i class="fa fa-link"></i> <span data-key="footer-education">å’Œå¹³æ•™è‚²ä¸­å¿ƒ</span></a>
                    <a href="https://www.warmuseum.nl" target="_blank"><i class="fa fa-link"></i> <span data-key="footer-history">æˆ˜äº‰å†å²æ¡£æ¡ˆé¦†</span></a>
                    <a href="https://www.unhcr.org" target="_blank"><i class="fa fa-link"></i> <span data-key="footer-refugee">éš¾æ°‘æ•‘åŠ©ç»„ç»‡</span></a>
                </div>
            </div>
        </div>

        <div class="copyright">
            <p id="footer-disclaimer">
                <strong>å…è´£å£°æ˜</strong>: æœ¬ç½‘ç«™éƒ¨åˆ†å†…å®¹æºè‡ªç½‘ç»œï¼Œç‰ˆæƒå½’åŸä½œè€…æ‰€æœ‰ã€‚å¦‚æœ‰ä¾µçŠ¯æ‚¨çš„åŸåˆ›ç‰ˆæƒï¼Œè¯·å‘ŠçŸ¥ï¼Œæˆ‘ä»¬å°†å°½å¿«åˆ é™¤ç›¸å…³å†…å®¹ã€‚
            </p>
            <p id="footer-compliance">
                æœ¬ç½‘ç«™ä¸¥æ ¼éµå®ˆã€Šäº’è”ç½‘ä¿¡æ¯æœåŠ¡ç®¡ç†åŠæ³•ã€‹åŠã€Šç½‘ç»œä¿¡æ¯å†…å®¹ç”Ÿæ€æ²»ç†è§„å®šã€‹ | å·²æ¥å…¥é•¿æ²™å¸‚äº’è”ç½‘è¿æ³•å’Œä¸è‰¯ä¿¡æ¯ä¸¾æŠ¥ä¸­å¿ƒ
            </p>
            <p id="footer-copyright">
                Â© 2025 å’Œå¹³è¡ŒåŠ¨å›½é™…ç»„ç»‡ ç‰ˆæƒæ‰€æœ‰ | XXç½‘å®‰å¤‡ 114514666888å· | ICPå¤‡æ¡ˆå·: æµ™ICPå¤‡1008666å·-1
            </p>
        </div>
    </footer>

    <script>
        // ç”¨æˆ·è¡Œä¸ºç±»å‹å®šä¹‰
        const BEHAVIOR_TYPES = {
            ACTION_TAG_CLICK: 'è¡ŒåŠ¨æ ‡ç­¾ç‚¹å‡»',
            MAP_TAG_CLICK: 'åœ°å›¾æ ‡è®°ç‚¹ç‚¹å‡»',
            MESSAGE_POST: 'å‘å¸ƒå’Œå¹³å®£è¨€',
            LIKE_MESSAGE: 'ç•™è¨€ç‚¹èµ',
            UNLIKE_MESSAGE: 'å–æ¶ˆç•™è¨€ç‚¹èµ',
            COMMENT_CLICK: 'è¯„è®ºæŒ‰é’®ç‚¹å‡»',
            SHARE_CLICK: 'åˆ†äº«æŒ‰é’®ç‚¹å‡»',
            GENERATE_LEAF: 'æ·»åŠ å’Œå¹³ä¹‹å¶',
            CLICK_LEAF: 'æŸ¥çœ‹å¶å­å®£è¨€',
            DOWNLOAD_RESOURCE: 'ä¸‹è½½èµ„æº',
            USER_LOGIN: 'ç”¨æˆ·ç™»å½•',
            USER_LOGOUT: 'ç”¨æˆ·é€€å‡º',
            MAP_FILTER: 'åœ°å›¾æ—¶é—´ç­›é€‰', // æ–°å¢
            ACTIVITY_JOIN: 'å‚ä¸æ´»åŠ¨' // æ–°å¢
        };

        // åˆå§‹åŒ–è¡Œä¸ºè®°å½•æ•°ç»„
        let userBehaviors = [];

        // è·å–å½“å‰ç”¨æˆ·ID
        function getCurrentUserId() {
            const user = JSON.parse(localStorage.getItem('currentUser'));
            return user ? user.id : null;
        }

        // ä»localStorageåŠ è½½è¡Œä¸ºè®°å½•
        function loadBehaviors() {
            const userId = getCurrentUserId();
            if (!userId) {
                console.log('ç”¨æˆ·æœªç™»å½•ï¼Œä¸åŠ è½½è¡Œä¸ºæ•°æ®');
                return;
            }

            const savedBehaviors = localStorage.getItem(`warTruthBehaviors_${userId}`);
            if (savedBehaviors) {
                userBehaviors = JSON.parse(savedBehaviors);
            }
        }

        // ä¿å­˜è¡Œä¸ºè®°å½•åˆ°localStorage
        function saveBehaviors() {
            const userId = getCurrentUserId();
            if (!userId) {
                console.log('ç”¨æˆ·æœªç™»å½•ï¼Œè¡Œä¸ºæ•°æ®ä¸ä¿å­˜');
                return;
            }

            localStorage.setItem(`warTruthBehaviors_${userId}`, JSON.stringify(userBehaviors));
        }

        // è®°å½•ç”¨æˆ·è¡Œä¸ºï¼ˆå¢å¼ºç‰ˆï¼Œå¢åŠ é•¿æ–‡æœ¬æˆªæ–­ï¼‰
        function recordBehavior(type, details = {}) {
            // æˆªæ–­é•¿æ–‡æœ¬
            if (details.content && details.content.length > 30) {
                details.content = details.content.substring(0, 30) + "...";
            }

            const behavior = {
                type,
                details,
                timestamp: new Date().toISOString()
            };

            userBehaviors.push(behavior);
            saveBehaviors();
            // showNotification(`å·²è®°å½•: ${type}`);
        }

        // æ˜¾ç¤ºé€šçŸ¥
        function showNotification(message) {
            const notification = document.createElement('div');
            notification.className = 'notification';
            notification.textContent = message;
            document.body.appendChild(notification);

            setTimeout(() => {
                if (notification.parentNode) {
                    document.body.removeChild(notification);
                }
            }, 3000);
        }

        // ç”¨æˆ·çŠ¶æ€ç®¡ç†
        function updateUserUI() {
            const user = JSON.parse(localStorage.getItem('currentUser'));
            const usernameDisplay = document.getElementById('username-display');
            const userAvatar = document.getElementById('user-avatar');
            const loginBtn = document.getElementById('login-btn');
            const logoutBtn = document.getElementById('logout-btn');
            const navLoginBtn = document.getElementById('nav-login-btn');
            const mobileLoginBtn = document.getElementById('mobile-login-btn');
            const profileLink = document.getElementById('profile-link'); // æ–°å¢

            if (user) {
                usernameDisplay.textContent = `æ¬¢è¿ï¼Œ${user.username}`;
                userAvatar.textContent = user.username.charAt(0).toUpperCase();

                // æ˜¾ç¤ºä¸ªäººä¸­å¿ƒé“¾æ¥
                profileLink.style.display = 'flex'; // æ–°å¢
                profileLink.style.alignItems = 'center'; // æ–°å¢
                profileLink.style.gap = '8px'; // æ–°å¢

                loginBtn.style.display = 'none';
                logoutBtn.style.display = 'inline-block';
                if (navLoginBtn) navLoginBtn.style.display = 'none';
                if (mobileLoginBtn) mobileLoginBtn.style.display = 'none';
            } else {
                usernameDisplay.textContent = '';
                userAvatar.textContent = '';
                profileLink.style.display = 'none'; // æ–°å¢
                loginBtn.style.display = 'inline-block';
                logoutBtn.style.display = 'none';
                if (navLoginBtn) navLoginBtn.style.display = 'block';
                if (mobileLoginBtn) mobileLoginBtn.style.display = 'block';
            }
        }

        // ç™»å½•æŒ‰é’®äº‹ä»¶
        function handleLogin() {
            window.location.href = 'denglu_xgawy.html';
        }

        // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–ç”¨æˆ·ç•Œé¢
        document.addEventListener('DOMContentLoaded', function() {
            updateUserUI();

            // ç§»åŠ¨ç«¯èœå•åˆ‡æ¢
            const mobileMenuButton = document.getElementById('mobile-menu-button');
            const mobileMenu = document.getElementById('mobile-menu');

            mobileMenuButton.addEventListener('click', function() {
                mobileMenu.classList.toggle('hidden');
            });

            // åŠ è½½è¡Œä¸ºæ•°æ®
            loadBehaviors();

        });

        // ç™»å½•æŒ‰é’®äº‹ä»¶ç»‘å®š
        document.getElementById('login-btn').addEventListener('click', handleLogin);
        document.getElementById('nav-login-btn').addEventListener('click', handleLogin);
        document.getElementById('mobile-login-btn').addEventListener('click', handleLogin);

        // é€€å‡ºæŒ‰é’®äº‹ä»¶
        document.getElementById('logout-btn').addEventListener('click', function() {
            const user = JSON.parse(localStorage.getItem('currentUser'));
            if (user) {
                recordBehavior(BEHAVIOR_TYPES.USER_LOGOUT, {
                    username: user.username
                });
            }

            localStorage.removeItem('currentUser');
            userBehaviors = [];
            updateUserUI();
            alert('æ‚¨å·²é€€å‡ºç™»å½•');
            location.reload();
        });

        // æ•°æ®å­˜å‚¨å’Œç®¡ç†
        function getMessages() {
            return JSON.parse(localStorage.getItem('messages')) || [];
        }

        function saveMessages(messages) {
            localStorage.setItem('messages', JSON.stringify(messages));
        }

        function getLeaves() {
            return JSON.parse(localStorage.getItem('peaceTreeLeaves')) || [];
        }

        function saveLeaves(leaves) {
            localStorage.setItem('peaceTreeLeaves', JSON.stringify(leaves));
        }

        // ç•™è¨€æ¿åŠŸèƒ½
        document.addEventListener('DOMContentLoaded', function() {
            // åˆå§‹åŒ–ç•™è¨€æ¿
            renderMessages();

            // å›¾ç‰‡ä¸Šä¼ é¢„è§ˆåŠŸèƒ½
            const imageInput = document.getElementById('message-image');
            const imagePreview = document.getElementById('image-preview');
            const imagePreviewContainer = document.getElementById('image-preview-container');
            const removeImageBtn = document.getElementById('remove-image');
            const postMessageBtn = document.getElementById('post-message');
            const messageText = document.getElementById('message-text');
            const messageFeed = document.getElementById('message-feed');
            const emotionButtons = document.querySelectorAll('.emotion-btn');
            const charCountElement = document.getElementById('char-count');
            const locationRadios = document.querySelectorAll('input[name="location"]');

            let selectedEmotion = 'happy';
            let uploadedImage = null;

            // å­—ç¬¦è®¡æ•°
            messageText.addEventListener('input', function() {
                const charCount = this.value.length;
                charCountElement.textContent = `${charCount}/280 å­—ç¬¦`;

                if (charCount > 250) {
                    charCountElement.classList.add('text-danger');
                    charCountElement.classList.remove('text-neutral-500');
                } else {
                    charCountElement.classList.remove('text-danger');
                    charCountElement.classList.add('text-neutral-500');
                }
            });

            // å¿ƒæƒ…é€‰æ‹©
            emotionButtons.forEach(button => {
                button.addEventListener('click', function() {
                    emotionButtons.forEach(btn => {
                        btn.classList.remove('bg-primary/20', 'text-primary');
                    });
                    this.classList.add('bg-primary/20', 'text-primary');
                    selectedEmotion = this.getAttribute('data-emotion');

                    // è®°å½•å¿ƒæƒ…é€‰æ‹©è¡Œä¸º
                    recordBehavior(BEHAVIOR_TYPES.COMMENT_CLICK, {
                        emotion: selectedEmotion
                    });
                });
            });

            // å›¾ç‰‡ä¸Šä¼ é¢„è§ˆ
            imageInput.addEventListener('change', function(e) {
                if (this.files && this.files[0]) {
                    const reader = new FileReader();

                    reader.onload = function(e) {
                        imagePreview.src = e.target.result;
                        imagePreviewContainer.classList.remove('hidden');
                        uploadedImage = e.target.result;
                    }

                    reader.readAsDataURL(this.files[0]);
                }
            });

            // ç§»é™¤å›¾ç‰‡
            removeImageBtn.addEventListener('click', function() {
                imagePreviewContainer.classList.add('hidden');
                imageInput.value = '';
                uploadedImage = null;
            });

            // å‘è¡¨ç•™è¨€
            postMessageBtn.addEventListener('click', function() {
                const user = JSON.parse(localStorage.getItem('currentUser'));
                if (!user) {
                    alert('è¯·å…ˆç™»å½•åå†å‘è¡¨å®£è¨€');
                    window.location.href = 'denglu_xgawy.html';
                    return;
                }

                const text = messageText.value.trim();
                if (text === '') {
                    alert('è¯·è¾“å…¥ç•™è¨€å†…å®¹');
                    return;
                }

                // è·å–é€‰æ‹©çš„ä½ç½®
                let selectedLocation = '';
                locationRadios.forEach(radio => {
                    if (radio.checked) {
                        selectedLocation = radio.value;
                    }
                });

                // åˆ›å»ºç•™è¨€å¯¹è±¡
                const message = {
                    id: 'msg_' + Date.now() + '_' + Math.random().toString(36).substr(2, 5),
                    userId: user.id,
                    username: user.username,
                    emotion: selectedEmotion,
                    content: text,
                    image: uploadedImage,
                    location: selectedLocation || 'å…¨çƒ',
                    timestamp: new Date().toISOString(),
                    likes: 0,
                    comments: 0
                };

                // ä¿å­˜ç•™è¨€
                const messages = getMessages();
                messages.unshift(message);
                saveMessages(messages);

                // è®°å½•å®£è¨€å‘å¸ƒè¡Œä¸ºï¼ˆå¢å¼ºç‰ˆï¼‰
                recordBehavior(BEHAVIOR_TYPES.MESSAGE_POST, {
                    content: text,
                    emotion: selectedEmotion,
                    location: selectedLocation || 'å…¨çƒ',
                    length: text.length
                });

                // é‡æ–°æ¸²æŸ“ç•™è¨€æ¿
                renderMessages();

                // é‡ç½®è¡¨å•
                messageText.value = '';
                charCountElement.textContent = '0/280 å­—ç¬¦';
                charCountElement.classList.remove('text-danger');
                charCountElement.classList.add('text-neutral-500');

                if (imagePreviewContainer.classList.contains('hidden') === false) {
                    imagePreviewContainer.classList.add('hidden');
                    imageInput.value = '';
                    uploadedImage = null;
                }

                // é‡ç½®ä½ç½®é€‰æ‹©
                locationRadios.forEach(radio => {
                    radio.checked = false;
                });
            });

            // ä½¿ç”¨äº‹ä»¶å§”æ‰˜å¤„ç†æ‰€æœ‰ç‚¹èµæŒ‰é’®
            document.addEventListener('click', function(e) {
                if (e.target.closest('.like-btn')) {
                    const button = e.target.closest('.like-btn');
                    handleLikeButtonClick(button);
                }

                // å¤„ç†åˆ é™¤æŒ‰é’®ç‚¹å‡»
                if (e.target.closest('.delete-btn')) {
                    const button = e.target.closest('.delete-btn');
                    const messageId = button.dataset.messageId;
                    deleteMessage(messageId);
                }
            });

            // é€šç”¨çš„ç‚¹èµåŠŸèƒ½å¤„ç†å‡½æ•°
            function handleLikeButtonClick(button) {
                const messageId = button.dataset.messageId;
                const messages = getMessages();
                const messageIndex = messages.findIndex(m => m.id === messageId);

                if (messageIndex !== -1) {
                    messages[messageIndex].likes += 1;
                    saveMessages(messages);

                    // è®°å½•ç‚¹èµè¡Œä¸ºï¼ˆå¢å¼ºç‰ˆï¼‰
                    const messageCard = button.closest('.message-card');
                    const messageContent = messageCard.querySelector('.message-content').textContent;
                    recordBehavior(BEHAVIOR_TYPES.LIKE_MESSAGE, {
                        messageId: messageId,
                        content: messageContent,
                        likes: messages[messageIndex].likes
                    });

                    renderMessages();
                }
            }

            // åˆ é™¤ç•™è¨€
            function deleteMessage(messageId) {
                const user = JSON.parse(localStorage.getItem('currentUser'));
                if (!user) return;

                const messages = getMessages();
                const messageIndex = messages.findIndex(m => m.id === messageId);

                if (messageIndex !== -1 && messages[messageIndex].userId === user.id) {
                    messages.splice(messageIndex, 1);
                    saveMessages(messages);
                    renderMessages();
                    alert('å®£è¨€å·²åˆ é™¤');
                }
            }

            // æ¸²æŸ“ç•™è¨€æ¿
            function renderMessages() {
                const messages = getMessages();
                const messageFeed = document.getElementById('message-feed');
                const user = JSON.parse(localStorage.getItem('currentUser'));

                messageFeed.innerHTML = '';

                messages.forEach(message => {
                    const isCurrentUser = user && user.id === message.userId;
                    const emotionLabel = getEmotionLabel(message.emotion);

                    const messageCard = document.createElement('div');
                    messageCard.className = 'message-card bg-white rounded-xl overflow-hidden shadow-lg card-hover';
                    messageCard.dataset.emotion = message.emotion;
                    messageCard.dataset.location = message.location;
                    messageCard.dataset.messageId = message.id; // æ·»åŠ æ¶ˆæ¯IDå±æ€§

                    let cardContent = `
                        <div class="p-5 relative">
                            <div class="absolute top-3 left-3">
                                <span class="px-2 py-1 rounded-full ${emotionLabel.color} text-white text-xs font-medium">
                                    ${emotionLabel.text}
                                </span>
                            </div>
                    `;

                    if (message.image) {
                        cardContent = `
                            <div class="relative">
                                <img src="${message.image}" alt="ç”¨æˆ·ä¸Šä¼ å›¾ç‰‡" class="w-full h-48 object-cover">
                                <div class="absolute top-3 left-3">
                                    <span class="px-2 py-1 rounded-full ${emotionLabel.color} text-white text-xs font-medium">
                                        ${emotionLabel.text}
                                    </span>
                                </div>
                            </div>
                        ` + cardContent;
                    }

                    cardContent += `
                        <h4 class="font-semibold text-neutral-700 mb-2">${message.content.substring(0, 20)}${message.content.length > 20 ? '...' : ''}</h4>
                        <p class="text-neutral-500 text-sm mb-4 message-content">${message.content}</p>
                        <div class="location-badge mb-3">
                            <i class="fa fa-map-marker text-primary"></i>
                            <span>${message.location}</span>
                        </div>
                        <div class="flex items-center justify-between">
                            <div class="flex items-center space-x-1">
                                <div class="w-8 h-8 rounded-full bg-primary flex items-center justify-center text-white">
                                    ${message.username.charAt(0).toUpperCase()}
                                </div>
                                <span class="text-xs text-neutral-500">${message.username} Â· ${formatTime(message.timestamp)}</span>
                            </div>
                            <div class="flex space-x-4">
                                <button class="text-neutral-400 hover:text-primary transition-colors like-btn" data-message-id="${message.id}">
                                    <i class="fa fa-thumbs-up mr-1"></i> <span class="like-count">${message.likes}</span>
                                </button>
                                <button class="text-neutral-400 hover:text-primary transition-colors comment-btn" data-message-id="${message.id}">
                                    <i class="fa fa-comment mr-1"></i> ${message.comments}
                                </button>
                                <button class="text-neutral-400 hover:text-primary transition-colors share-btn" data-message-id="${message.id}">
                                    <i class="fa fa-share-alt"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                    `;

                    if (isCurrentUser) {
                        cardContent += `
                            <div class="p-3 border-t border-neutral-100 text-center">
                                <button class="delete-btn" data-message-id="${message.id}">
                                    æ’¤å›å®£è¨€
                                </button>
                            </div>
                        `;
                    }

                    messageCard.innerHTML = cardContent;
                    messageFeed.appendChild(messageCard);
                });

                // ä¸ºè¯„è®ºå’Œåˆ†äº«æŒ‰é’®æ·»åŠ äº‹ä»¶ç›‘å¬å™¨
                document.querySelectorAll('.comment-btn').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const messageId = this.getAttribute('data-message-id');
                        recordBehavior(BEHAVIOR_TYPES.COMMENT_CLICK, {
                            messageId
                        });
                        alert('è¯„è®ºåŠŸèƒ½å³å°†å¼€æ”¾');
                    });
                });

                document.querySelectorAll('.share-btn').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const messageId = this.getAttribute('data-message-id');
                        recordBehavior(BEHAVIOR_TYPES.SHARE_CLICK, {
                            messageId
                        });
                        alert('åˆ†äº«åŠŸèƒ½å³å°†å¼€æ”¾');
                    });
                });
            }

            function getEmotionLabel(emotion) {
                switch (emotion) {
                    case 'sad':
                        return {
                            text: 'ğŸ˜¢ æ‚²ä¼¤',
                            color: 'bg-blue-500'
                        };
                    case 'angry':
                        return {
                            text: 'ğŸ˜  æ„¤æ€’',
                            color: 'bg-red-500'
                        };
                    case 'happy':
                        return {
                            text: 'âœŒ å¸Œæœ›',
                            color: 'bg-green-500'
                        };
                    case 'love':
                        return {
                            text: 'â¤ çˆ±',
                            color: 'bg-pink-500'
                        };
                    default:
                        return {
                            text: 'âœŒ å¸Œæœ›',
                            color: 'bg-green-500'
                        };
                }
            }

            function formatTime(timestamp) {
                const now = new Date();
                const msgDate = new Date(timestamp);
                const diff = Math.floor((now - msgDate) / 1000); // ç§’æ•°å·®

                if (diff < 60) return 'åˆšåˆš';
                if (diff < 3600) return `${Math.floor(diff / 60)}åˆ†é’Ÿå‰`;
                if (diff < 86400) return `${Math.floor(diff / 3600)}å°æ—¶å‰`;
                if (diff < 604800) return `${Math.floor(diff / 86400)}å¤©å‰`;

                return msgDate.toLocaleDateString();
            }

            // å’Œå¹³ä¹‹æ ‘åŠŸèƒ½
            const addLeafButton = document.getElementById('add-leaf');
            const treeMessage = document.getElementById('tree-message');
            const treeLeavesContainer = document.getElementById('tree-leaves');
            const leafColorButtons = document.querySelectorAll('.leaf-color');
            const totalLeavesElement = document.getElementById('total-leaves');

            let selectedColor = 'green-500';

            // åˆå§‹åŒ–å’Œå¹³ä¹‹æ ‘
            renderTree();

            // é€‰æ‹©å¶å­é¢œè‰²
            leafColorButtons.forEach(button => {
                button.addEventListener('click', function() {
                    selectedColor = this.dataset.color;
                    leafColorButtons.forEach(btn => btn.classList.remove('border-neutral-600'));
                    this.classList.add('border-neutral-600');
                });
            });

            // æ·»åŠ å¶å­
            addLeafButton.addEventListener('click', function() {
                const user = JSON.parse(localStorage.getItem('currentUser'));
                if (!user) {
                    alert('è¯·å…ˆç™»å½•åå†æ·»åŠ å’Œå¹³ä¹‹å¶');
                    window.location.href = 'denglu_xgawy.html';
                    return;
                }

                const message = treeMessage.value.trim();
                if (message === '') return;

                // åˆ›å»ºå¶å­å¯¹è±¡
                const leaf = {
                    id: 'leaf_' + Date.now() + '_' + Math.random().toString(36).substr(2, 5),
                    userId: user.id,
                    username: user.username,
                    message: message,
                    color: selectedColor,
                    left: Math.random() * 70 + 15,
                    top: Math.random() * 40 + 30,
                    rotation: Math.random() * 60 - 30,
                    timestamp: new Date().toISOString()
                };

                // ä¿å­˜å¶å­
                const leaves = getLeaves();
                leaves.push(leaf);
                saveLeaves(leaves);

                // è®°å½•å¶å­æ·»åŠ è¡Œä¸ºï¼ˆå¢å¼ºç‰ˆï¼‰
                recordBehavior(BEHAVIOR_TYPES.GENERATE_LEAF, {
                    content: message,
                    color: selectedColor,
                    length: message.length
                });

                // é‡æ–°æ¸²æŸ“å’Œå¹³ä¹‹æ ‘
                renderTree();

                // æ¸…ç©ºè¾“å…¥æ¡†
                treeMessage.value = '';

                // æ›´æ–°è®¡æ•°å™¨
                const totalLeaves = leaves.length;
                totalLeavesElement.textContent = totalLeaves.toLocaleString();

                // æ˜¾ç¤ºæˆåŠŸæç¤º
                alert('ä½ çš„å’Œå¹³ä¹‹å¶å·²æ·»åŠ åˆ°æ ‘ä¸Šï¼');
            });

            // æ¸²æŸ“å’Œå¹³ä¹‹æ ‘
            function renderTree() {
                const leaves = getLeaves();
                const user = JSON.parse(localStorage.getItem('currentUser'));
                treeLeavesContainer.innerHTML = '';

                leaves.forEach(leaf => {
                    const isCurrentUser = user && user.id === leaf.userId;

                    const leafElement = document.createElement('div');
                    leafElement.className = `absolute w-16 h-16 bg-${leaf.color} rounded-full opacity-90 flex items-center justify-center text-white text-xs font-medium text-center p-2 cursor-pointer transform transition-all hover:scale-110 hover:z-10 hover:shadow-md`;
                    leafElement.style.left = `${leaf.left}%`;
                    leafElement.style.top = `${leaf.top}%`;
                    leafElement.style.transform = `rotate(${leaf.rotation}deg)`;
                    leafElement.innerHTML = `<span class="leaf-text">${leaf.message}</span>`;

                    if (isCurrentUser) {
                        leafElement.innerHTML += `
                            <div class="absolute bottom-0 left-0 right-0 bg-black bg-opacity-50 text-white text-xs p-1 text-center">
                                <button class="delete-leaf" data-leaf-id="${leaf.id}">æ’¤å›</button>
                            </div>
                        `;
                    }

                    treeLeavesContainer.appendChild(leafElement);
                });

                // ä¸ºå¶å­æ·»åŠ ç‚¹å‡»äº‹ä»¶
                document.querySelectorAll('.leaf-text').forEach(leaf => {
                    leaf.addEventListener('click', function() {
                        const leafText = this.textContent;
                        recordBehavior(BEHAVIOR_TYPES.CLICK_LEAF, {
                            message: leafText.substring(0, 30)
                        });
                    });
                });

                // æ·»åŠ åˆ é™¤äº‹ä»¶ç›‘å¬
                document.querySelectorAll('.delete-leaf').forEach(btn => {
                    btn.addEventListener('click', function(e) {
                        e.stopPropagation();
                        const leafId = this.dataset.leafId;
                        deleteLeaf(leafId);
                    });
                });

                // æ›´æ–°è®¡æ•°å™¨
                totalLeavesElement.textContent = leaves.length.toLocaleString();
            }

            // åˆ é™¤å¶å­
            function deleteLeaf(leafId) {
                const user = JSON.parse(localStorage.getItem('currentUser'));
                if (!user) return;

                const leaves = getLeaves();
                const leafIndex = leaves.findIndex(l => l.id === leafId);

                if (leafIndex !== -1 && leaves[leafIndex].userId === user.id) {
                    leaves.splice(leafIndex, 1);
                    saveLeaves(leaves);
                    renderTree();
                    alert('å’Œå¹³ä¹‹å¶å·²æ’¤å›');
                }
            }
        });

        // å®Œæ•´çš„è¡ŒåŠ¨æ•°æ® (æ—§é¡µé¢æ•°æ®)
        const actionData = {
            online: {
                title: "çº¿ä¸Šè¡ŒåŠ¨",
                activities: [{
                    title: "å…¨çƒæ°”å€™å˜åŒ–è”ç½²",
                    description: "å‘¼åå›½é™…ç¤¾ä¼šå…³æ³¨æ°”å€™å˜åŒ–é—®é¢˜ï¼Œç­¾ç½²è”åä¿¡æäº¤ç»™è”åˆå›½ç¯å¢ƒç½²",
                    progress: {
                        target: "10ä¸‡ç­¾å",
                        current: "85%",
                        width: "85%"
                    },
                    buttonText: "ç«‹å³ç­¾å",
                    buttonColor: "bg-primary"
                }, {
                    title: "çº¿ä¸Šå’Œå¹³è®ºå›",
                    description: "å‚ä¸å…¨çƒå’Œå¹³è®ºå›ï¼Œä¸æ¥è‡ªä¸–ç•Œå„åœ°çš„å’Œå¹³å€¡å¯¼è€…äº¤æµæƒ³æ³•å’Œç»éªŒ",
                    details: [{
                        label: "è®ºå›ä¸»é¢˜",
                        value: "æ•™è‚²ä¸å’Œå¹³"
                    }, {
                        label: "æ—¶é—´",
                        value: "ä¸‹å‘¨å…­ 19:00-21:00"
                    }],
                    buttonText: "é¢„çº¦å‚åŠ ",
                    buttonColor: "bg-primary"
                }, {
                    title: "å’Œå¹³æ•…äº‹åˆ†äº«ä¼š",
                    description: "åˆ†äº«ä½ çš„å’Œå¹³æ•…äº‹ï¼Œè†å¬ä»–äººçš„ç»å†ï¼Œå…±åŒä¼ é€’å’Œå¹³çš„åŠ›é‡",
                    details: [{
                        label: "ç»„ç»‡è€…",
                        value: "å’Œå¹³è¡ŒåŠ¨å¹³å°"
                    }, {
                        label: "æ—¶é—´",
                        value: "æ¯å‘¨ä¸‰ 20:00"
                    }],
                    buttonText: "å‚ä¸è®¨è®º",
                    buttonColor: "bg-primary"
                }]
            },
            offline: {
                title: "çº¿ä¸‹è¡ŒåŠ¨",
                activities: [{
                    title: "åŸå¸‚å’Œå¹³éŸ³ä¹ä¼š",
                    description: "æ±‡èšçŸ¥åè‰ºäººçš„å…¬ç›ŠéŸ³ä¹ä¼šï¼Œé—¨ç¥¨æ”¶å…¥å°†ç”¨äºæ”¯æŒå†²çªåœ°åŒºå„¿ç«¥æ•™è‚²",
                    details: [{
                        label: "æ´»åŠ¨åœ°ç‚¹",
                        value: "åŸå¸‚å…¬å›­éœ²å¤©å‰§åœº"
                    }, {
                        label: "è‰ºäººé˜µå®¹",
                        value: "3ä½çŸ¥åæ­Œæ‰‹"
                    }],
                    progress: {
                        title: "å¿—æ„¿è€…æ‹›å‹Ÿ",
                        current: "12/50äºº",
                        width: "24%"
                    },
                    buttonText: "ç”³è¯·å¿—æ„¿è€…",
                    buttonColor: "bg-secondary"
                }, {
                    title: "ç¤¾åŒºæ¸…æ´æ´»åŠ¨",
                    description: "ç»„ç»‡ç¤¾åŒºå±…æ°‘å…±åŒå‚ä¸ç¯å¢ƒæ¸…æ´ï¼Œè¥é€ æ›´ç¾å¥½çš„ç”Ÿæ´»ç©ºé—´",
                    details: [{
                        label: "æ´»åŠ¨åœ°ç‚¹",
                        value: "ç¤¾åŒºå…¬å›­"
                    }, {
                        label: "æ—¶é—´",
                        value: "æœ¬å‘¨æ—¥ 9:00-11:00"
                    }],
                    buttonText: "æŠ¥åå‚åŠ ",
                    buttonColor: "bg-secondary"
                }, {
                    title: "å’Œå¹³æ¸¸è¡Œ",
                    description: "é€šè¿‡å’Œå¹³æ¸¸è¡Œè¡¨è¾¾å¯¹å’Œå¹³çš„æ¸´æœ›ï¼Œå‘¼åç¤¾ä¼šå…³æ³¨å†²çªè§£å†³",
                    details: [{
                        label: "æ¸¸è¡Œè·¯çº¿",
                        value: "å¸‚æ”¿å…â†’ä¸­å¤®å¹¿åœº"
                    }, {
                        label: "æ—¶é—´",
                        value: "ä¸‹å‘¨æ—¥ 14:00"
                    }],
                    buttonText: "å‚ä¸æ¸¸è¡Œ",
                    buttonColor: "bg-secondary"
                }]
            },
            education: {
                title: "æ•™è‚²è¡ŒåŠ¨",
                activities: [{
                    title: "å’Œå¹³æ•™è‚²å·¥ä½œåŠ",
                    description: "é¢å‘é’å°‘å¹´çš„å’Œå¹³æ•™è‚²ç³»åˆ—å·¥ä½œåŠï¼ŒåŸ¹å…»å†²çªè§£å†³ä¸æ²Ÿé€šæŠ€å·§",
                    details: [{
                        label: "ä¸¾åŠåœ°ç‚¹",
                        value: "ç¤¾åŒºæ´»åŠ¨ä¸­å¿ƒ"
                    }, {
                        label: "é€‚åˆå¹´é¾„",
                        value: "12-18å²"
                    }],
                    buttonText: "äº†è§£è¯¦æƒ…",
                    buttonColor: "bg-accent"
                }, {
                    title: "å’Œå¹³ä¸»é¢˜è®²åº§",
                    description: "é‚€è¯·ä¸“å®¶åˆ†äº«å’Œå¹³å‘å±•çš„æœ€æ–°è¶‹åŠ¿å’Œå®è·µç»éªŒ",
                    details: [{
                        label: "ä¸¾åŠåœ°ç‚¹",
                        value: "å­¦æ ¡ç¤¼å ‚"
                    }, {
                        label: "é€‚åˆäººç¾¤",
                        value: "å­¦ç”Ÿå’Œæ•™å¸ˆ"
                    }],
                    buttonText: "äº†è§£è¯¦æƒ…",
                    buttonColor: "bg-accent"
                }, {
                    title: "æ ¡å›­å’Œå¹³å¤§ä½¿è®¡åˆ’",
                    description: "åŸ¹è®­å­¦ç”Ÿæˆä¸ºæ ¡å›­å’Œå¹³å¤§ä½¿ï¼Œä¿ƒè¿›æ ¡å›­å’Œè°æ°›å›´",
                    details: [{
                        label: "ä¸¾åŠåœ°ç‚¹",
                        value: "å„ä¸­å°å­¦"
                    }, {
                        label: "ä¸»åŠæ–¹",
                        value: "æ•™è‚²éƒ¨ä¸å’Œå¹³ç»„ç»‡"
                    }],
                    buttonText: "ç”³è¯·åŠ å…¥",
                    buttonColor: "bg-accent"
                }]
            },
            emergency: {
                title: "ç´§æ€¥å“åº”",
                activities: [{
                    title: "è‡ªç„¶ç¾å®³æ•‘æ´",
                    description: "ä¸ºå—ç¾åœ°åŒºæä¾›ç´§æ€¥æ•‘æ´ç‰©èµ„å’Œæ´åŠ©",
                    buttonText: "ç«‹å³å‚ä¸",
                    buttonColor: "bg-danger"
                }, {
                    title: "å†²çªåœ°åŒºäººé“æ´åŠ©",
                    description: "ä¸ºå†²çªåœ°åŒºçš„å±…æ°‘æä¾›é£Ÿå“ã€åŒ»ç–—å’Œå®‰å…¨ä¿éšœ",
                    buttonText: "ç«‹å³å‚ä¸",
                    buttonColor: "bg-danger"
                }, {
                    title: "å…¬å…±å«ç”Ÿäº‹ä»¶åº”å¯¹",
                    description: "ååŠ©åŒ»ç–—æœºæ„è¿›è¡Œç–«æƒ…é˜²æ§å’Œæ•‘æ²»å·¥ä½œ",
                    buttonText: "ç«‹å³å‚ä¸",
                    buttonColor: "bg-danger"
                }]
            }
        };

        // åœ°å›¾å’Œæ´»åŠ¨åŠŸèƒ½
        document.addEventListener('DOMContentLoaded', function() {
                    // æ—¶é—´æ»‘å—äº¤äº’
                    const timeSlider = document.getElementById('time-slider');
                    const timeSliderValue = document.getElementById('time-slider-value');

                    // åœ¨åˆ›å»ºåœ°å›¾æ ‡è®°åæ·»åŠ 
                    let allMarkers = []; // å­˜å‚¨æ‰€æœ‰æ ‡è®°çš„æ•°ç»„
                    let visibleMarkers = []; // å­˜å‚¨å½“å‰å¯è§æ ‡è®°

                    // åœ¨æ—¶é—´æ»‘å—äº‹ä»¶ç›‘å¬å™¨ä¸­æ·»åŠ è¿‡æ»¤é€»è¾‘
                    timeSlider.addEventListener('input', function() {
                        const days = parseInt(this.value);
                        timeSliderValue.textContent = `æœªæ¥${days}å¤©`;

                        // è®°å½•æ—¶é—´æ»‘å—å˜åŒ–è¡Œä¸ºï¼ˆæ–°å¢ï¼‰
                        recordBehavior(BEHAVIOR_TYPES.MAP_FILTER, {
                            days: days
                        });

                        // æ ¹æ®æ—¶é—´èŒƒå›´è¿‡æ»¤æ ‡è®°
                        filterMarkersByDays(days);
                    });

                    // æ–°å¢ï¼šè¿‡æ»¤æ ‡è®°å‡½æ•°
                    function filterMarkersByDays(days) {
                        // ç§»é™¤æ‰€æœ‰æ ‡è®°
                        allMarkers.forEach(marker => {
                            map.removeLayer(marker.leafletMarker);
                        });

                        // æ·»åŠ ç¬¦åˆæ—¶é—´èŒƒå›´çš„æ ‡è®°
                        allMarkers.forEach(marker => {
                            if (marker.daysFromNow <= days) {
                                marker.leafletMarker.addTo(map);
                                visibleMarkers.push(marker.leafletMarker);
                            }
                        });

                        // è‡ªåŠ¨è°ƒæ•´è§†å›¾ä»¥æ˜¾ç¤ºæ‰€æœ‰å¯è§æ ‡è®°
                        if (visibleMarkers.length > 0) {
                            const markerGroup = new L.featureGroup(visibleMarkers);
                            map.fitBounds(markerGroup.getBounds());
                        }

                        // æ¸…ç©ºå¯è§æ ‡è®°æ•°ç»„
                        visibleMarkers = [];
                    }

                    // ä¿®æ”¹åœ°å›¾è§†å›¾è®¾ç½®
                    const map = L.map('map').setView([30, 110], 2); // ç¼©å°åˆå§‹ç¼©æ”¾çº§åˆ«

                    // æ·»åŠ  OpenStreetMap åº•å›¾
                    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                        attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
                    }).addTo(map);

                    // å®šä¹‰å››ç§è¡ŒåŠ¨ç±»å‹çš„å›¾æ ‡
                    const icons = {
                        online: L.divIcon({
                            className: 'online-marker ',
                            html: '<div class="w-8 h-8 rounded-full bg-primary/80 flex items-center justify-center text-white shadow-lg"><i class="fa fa-globe text-sm"></i></div>',
                            iconSize: [32, 32],
                            iconAnchor: [16, 16]
                        }),
                        offline: L.divIcon({
                            className: 'offline-marker ',
                            html: '<div class="w-10 h-10 rounded-full bg-secondary/80 flex items-center justify-center text-white shadow-lg"><i class="fa fa-music text-base"></i></div>',
                            iconSize: [40, 40],
                            iconAnchor: [20, 20]
                        }),
                        education: L.divIcon({
                            className: 'education-marker ',
                            html: '<div class="w-9 h-9 rounded-full bg-accent/80 flex items-center justify-center text-white shadow-lg"><i class="fa fa-graduation-cap text-sm"></i></div>',
                            iconSize: [36, 36],
                            iconAnchor: [18, 18]
                        }),
                        emergency: L.divIcon({
                            className: 'emergency-marker ',
                            html: '<div class="w-12 h-12 rounded-full bg-danger/80 flex items-center justify-center text-white shadow-lg"><i class="fa fa-exclamation-triangle text-base"></i></div>',
                            iconSize: [48, 48],
                            iconAnchor: [24, 24]
                        })
                    };

                    // æ·»åŠ æ ‡è®°ç‚¹
                    const markers = [{
                        type: 'online',
                        id: 'online-1',
                        title: 'å…¨çƒæ°”å€™å˜åŒ–è”ç½²',
                        lat: 40.71, // çº½çº¦(è”åˆå›½æ€»éƒ¨)
                        lng: -74.00,
                        daysFromNow: 5
                    }, {
                        type: 'online',
                        id: 'online-2',
                        title: 'çº¿ä¸Šå’Œå¹³è®ºå›',
                        lat: 51.51, // ä¼¦æ•¦
                        lng: -0.13,
                        daysFromNow: 15
                    }, {
                        type: 'online',
                        id: 'online-3',
                        title: 'å’Œå¹³æ•…äº‹åˆ†äº«ä¼š',
                        lat: -33.86, // æ‚‰å°¼
                        lng: 151.21,
                        daysFromNow: 8
                    }, {
                        type: 'offline',
                        id: 'offline-1',
                        title: 'åŸå¸‚å’Œå¹³éŸ³ä¹ä¼š',
                        lat: 48.85, // å·´é»
                        lng: 2.35,
                        daysFromNow: 25
                    }, {
                        type: 'offline',
                        id: 'offline-2',
                        title: 'ç¤¾åŒºæ¸…æ´æ´»åŠ¨',
                        lat: 39.90, // åŒ—äº¬
                        lng: 116.40,
                        daysFromNow: 10
                    }, {
                        type: 'offline',
                        id: 'offline-3',
                        title: 'å’Œå¹³æ¸¸è¡Œ',
                        lat: 52.52, // æŸæ—
                        lng: 13.40,
                        daysFromNow: 35
                    }, {
                        type: 'education',
                        id: 'education-1',
                        title: 'å’Œå¹³æ•™è‚²å·¥ä½œåŠ',
                        lat: 28.61, // æ–°å¾·é‡Œ
                        lng: 77.23,
                        daysFromNow: 12
                    }, {
                        type: 'education',
                        id: 'education-2',
                        title: 'å’Œå¹³ä¸»é¢˜è®²åº§',
                        lat: 35.68, // ä¸œäº¬
                        lng: 139.76,
                        daysFromNow: 22
                    }, {
                        type: 'education',
                        id: 'education-3',
                        title: 'æ ¡å›­å’Œå¹³å¤§ä½¿è®¡åˆ’',
                        lat: -22.91, // é‡Œçº¦çƒ­å†…å¢
                        lng: -43.17,
                        daysFromNow: 45
                    }, {
                        type: 'emergency',
                        id: 'emergency-1',
                        title: 'è‡ªç„¶ç¾å®³æ•‘æ´',
                        lat: -6.21, // é›…åŠ è¾¾(åœ°éœ‡å¤šå‘åŒº)
                        lng: 106.85,
                        daysFromNow: 3
                    }, {
                        type: 'emergency',
                        id: 'emergency-2',
                        title: 'å†²çªåœ°åŒºäººé“æ´åŠ©',
                        lat: 50.45, // åŸºè¾…
                        lng: 30.52,
                        daysFromNow: 1
                    }, {
                        type: 'emergency',
                        id: 'emergency-3',
                        title: 'å…¬å…±å«ç”Ÿäº‹ä»¶åº”å¯¹',
                        lat: 46.20, // æ—¥å†…ç“¦(WHOæ€»éƒ¨)
                        lng: 6.15,
                        daysFromNow: 2
                    }];

                    // ä¿®æ”¹æ ‡è®°åˆ›å»ºéƒ¨åˆ†
                    markers.forEach(markerData => {
                        const marker = L.marker([markerData.lat, markerData.lng], {
                            icon: icons[markerData.type],
                            title: markerData.title
                        }).addTo(map);

                        marker.on('click', () => {
                            // è®°å½•åœ°å›¾æ ‡è®°ç‚¹å‡»è¡Œä¸º
                            recordBehavior(BEHAVIOR_TYPES.MAP_TAG_CLICK, {
                                markerName: markerData.title,
                                markerType: markerData.type,
                                lat: markerData.lat,
                                lng: markerData.lng
                            });

                            loadActivityContent(markerData.type, markerData.id);
                        });

                        // å­˜å‚¨æ ‡è®°å¯¹è±¡å’Œå…ƒæ•°æ®
                        allMarkers.push({
                            leafletMarker: marker,
                            daysFromNow: markerData.daysFromNow,
                            type: markerData.type,
                            id: markerData.id
                        });
                    });

                    // åˆå§‹åŠ è½½æ—¶åº”ç”¨é»˜è®¤æ—¶é—´èŒƒå›´
                    filterMarkersByDays(parseInt(timeSlider.value));

                    // è·å– DOM å…ƒç´ 
                    const emptyState = document.getElementById('empty-state');

                    // é»˜è®¤åŠ è½½çº¿ä¸Šè¡ŒåŠ¨å†…å®¹
                    loadActivityContent('online');

                    // ç»‘å®šæ ‡ç­¾ç‚¹å‡»äº‹ä»¶
                    document.querySelectorAll('.action-tag').forEach(tag => {
                        tag.addEventListener('click', function(e) {
                            e.preventDefault();

                            const actionType = this.getAttribute('data-action');

                            // è®°å½•æ ‡ç­¾ç‚¹å‡»è¡Œä¸º
                            recordBehavior(BEHAVIOR_TYPES.ACTION_TAG_CLICK, {
                                actionType
                            });

                            // æ›´æ–°æ ‡ç­¾æ ·å¼
                            document.querySelectorAll('.action-tag').forEach(t => {
                                t.classList.remove('bg-primary', 'text-white');
                                t.classList.add('bg-white', 'text-neutral-600', 'border', 'border-neutral-200');
                            });

                            this.classList.add('bg-primary', 'text-white');
                            this.classList.remove('bg-white', 'text-neutral-600', 'border', 'border-neutral-200');

                            // åŠ è½½å¯¹åº”å†…å®¹
                            loadActivityContent(this.getAttribute('data-action'));
                        });
                    });

                    // åŠ è½½æ´»åŠ¨å†…å®¹å‡½æ•°
                    function loadActivityContent(actionType, highlightId = null) {
                        const container = document.getElementById('activity-container');

                        if (!actionData[actionType]) {
                            console.error("æ— æ•ˆçš„è¡ŒåŠ¨ç±»å‹:", actionType);
                            return;
                        }

                        // éšè—ç©ºçŠ¶æ€
                        emptyState.classList.add('hidden');

                        // ç”Ÿæˆæ´»åŠ¨å¡ç‰‡HTML
                        const activitiesHTML = actionData[actionType].activities.map((activity, index) => {
                                    const activityId = `${actionType}-${index + 1}`;
                                    const isHighlighted = highlightId === activityId;

                                    // ç”Ÿæˆè¯¦æƒ…HTML
                                    const detailsHTML = activity.details ? `
                <div class="grid grid-cols-2 gap-4 mb-4">
                    ${activity.details.map(detail => `
                        <div>
                            <div class="text-sm text-neutral-500">${detail.label}</div>
                            <div class="text-neutral-700 font-medium">${detail.value}</div>
                        </div>
                    `).join('')}
                </div>
            ` : '';

                    // ç”Ÿæˆè¿›åº¦æ¡HTML
                    const progressHTML = activity.progress ? `
                <div class="mb-4">
                    <div class="flex justify-between text-sm mb-1">
                        <span class="text-neutral-600">${activity.progress.title || ''}</span>
                        <span class="text-${activity.buttonColor === 'bg-danger' ? 'danger' : 'primary'} font-medium">${activity.progress.current}</span>
                    </div>
                    <div class="w-full h-2 bg-neutral-200 rounded-full overflow-hidden">
                        <div class="h-full ${activity.buttonColor} rounded-full" style="width: ${activity.progress.width}"></div>
                    </div>
                </div>
            ` : '';

                    // ä¿®æ”¹æŒ‰é’®ä¸ºé“¾æ¥ - æ·»åŠ aæ ‡ç­¾
                    return `
            <div class="bg-white rounded-xl shadow-lg p-6 mb-6 ${isHighlighted ? 'ring-2 ring-primary' : ''}" id="${activityId}">
                <h4 class="text-xl font-semibold text-neutral-700 mb-3">${activity.title}</h4>
                <p class="text-neutral-500 mb-4">${activity.description}</p>
                ${detailsHTML}
                ${progressHTML}
                <a href="huodong_xgawy.html?type=${actionType}" class="block w-full py-2 rounded-lg ${activity.buttonColor} text-white font-medium hover:opacity-90 transition-colors text-center">
                    ${activity.buttonText}
                </a>
            </div>
        `;
                }).join('');

                // æ›´æ–°å®¹å™¨å†…å®¹
                container.innerHTML = `
            <div class="p-6">
                <h3 class="text-2xl font-bold text-neutral-700 mb-6">${actionData[actionType].title}</h3>
                <div class="space-y-4">
                    ${activitiesHTML}
                </div>
            </div>
        `;

                // æ»šåŠ¨åˆ°é«˜äº®æ´»åŠ¨
                if (highlightId) {
                    setTimeout(() => {
                        const element = document.getElementById(highlightId);
                        if (element) {
                            element.scrollIntoView({ behavior: 'smooth', block: 'center' });
                        }
                    }, 100);
                }

                // ä¸ºæ´»åŠ¨æŒ‰é’®æ·»åŠ äº‹ä»¶ç›‘å¬ï¼ˆæ–°å¢ï¼‰
                document.querySelectorAll('.activity-btn').forEach(button => {
                    button.addEventListener('click', function () {
                        const activityTitle = this.closest('.activity-card').querySelector('.activity-title').textContent;
                        recordBehavior(BEHAVIOR_TYPES.ACTIVITY_JOIN, {
                            activity: activityTitle
                        });
                        alert(`å¼€å§‹å‚ä¸æ´»åŠ¨: ${activityTitle}`);
                    });
                });
            }

            // èµ„æºä¸‹è½½è¡Œä¸ºè®°å½•
            document.querySelectorAll('.download-btn').forEach(button => {
                button.addEventListener('click', function () {
                    const resourceType = this.getAttribute('data-resource');
                    let resourceName = '';

                    switch (resourceType) {
                        case 'protest-poster':
                            resourceName = 'æŠ—è®®æµ·æŠ¥æ¨¡æ¿';
                            break;
                        case 'community-guide':
                            resourceName = 'ç¤¾åŒºè¡ŒåŠ¨æŒ‡å—';
                            break;
                        case 'promotion-example':
                            resourceName = 'å®£ä¼ æ–‡æ¡ˆèŒƒä¾‹';
                            break;
                    }

                    recordBehavior(BEHAVIOR_TYPES.DOWNLOAD_RESOURCE, {
                        resource: resourceName
                    });

                    // æ¨¡æ‹Ÿä¸‹è½½
                    alert(`å¼€å§‹ä¸‹è½½: ${resourceName}`);
                });
            });
        });
    </script>
</body>

</html>