<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>战争真相 | 沉浸式数据叙事</title>
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link
        href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;700&family=Roboto:wght@300;400;700&display=swap"
        rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.css">
    <link rel="icon" href="data:;base64,iVBORw0KGgo=">

    <style>
        /* 原有样式保持不变 */

        /* 新增页脚优化样式 */
        #footer {
            background: linear-gradient(135deg, #050508 0%, #0a0a0f 100%);
            padding: 50px 0 20px;
            border-top: 1px solid rgba(100, 100, 120, 0.3);
            margin-top: 50px;
        }

        .footer-container {
            max-width: 1800px;
            margin: 0 auto;
            padding: 0 20px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 30px;
        }

        .footer-section {
            padding: 15px;
        }

        .footer-section h3 {
            font-size: 1.4rem;
            color: var(--accent-gold);
            margin-bottom: 25px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--border-color);
            position: relative;
        }

        .footer-section h3::after {
            content: '';
            position: absolute;
            bottom: -1px;
            left: 0;
            width: 60px;
            height: 2px;
            background: var(--accent-gold);
        }

        .footer-about {
            grid-column: span 2;
        }

        .footer-about p {
            margin-bottom: 20px;
            line-height: 1.8;
        }

        .social-links {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }

        .social-links a {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(252, 163, 17, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--accent-gold);
            transition: all 0.3s ease;
        }

        .social-links a:hover {
            background: var(--accent-gold);
            color: #000;
            transform: translateY(-3px);
        }

        .footer-links {
            list-style: none;
        }

        .footer-links li {
            margin-bottom: 15px;
        }

        .footer-links a {
            color: var(--light-text);
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s ease;
        }

        .footer-links a:hover {
            color: var(--accent-gold);
            transform: translateX(5px);
        }

        .footer-links a i {
            color: var(--accent-gold);
            font-size: 0.8rem;
        }

        .contact-info {
            list-style: none;
        }

        .contact-info li {
            margin-bottom: 20px;
            display: flex;
            align-items: flex-start;
            gap: 15px;
        }

        .contact-info i {
            color: var(--accent-gold);
            font-size: 1.2rem;
            min-width: 24px;
            margin-top: 3px;
        }

        .friend-links {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
        }

        .friend-links a {
            color: var(--light-text);
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s ease;
        }

        .friend-links a:hover {
            color: var(--accent-gold);
        }

        .friend-links a i {
            color: var(--accent-gold);
            font-size: 0.9rem;
        }

        .copyright {
            margin-top: 50px;
            padding-top: 25px;
            border-top: 1px solid var(--border-color);
            text-align: center;
            font-size: 0.85rem;
            line-height: 1.8;
            opacity: 0.7;
        }

        .copyright strong {
            color: var(--accent-gold);
            font-weight: 600;
        }

        /* 响应式调整 */
        @media (max-width: 992px) {
            .footer-about {
                grid-column: span 1;
            }
        }

        @media (max-width: 768px) {
            .footer-container {
                grid-template-columns: 1fr;
            }

            .footer-section h3 {
                margin-bottom: 20px;
            }

            .copyright {
                text-align: left;
                padding: 20px;
            }
        }

        /* 用户栏样式 */
        .user-bar {
            background: rgba(20, 20, 30, 0.9);
            padding: 5px 0;
            border-bottom: 1px solid var(--border-color);
        }

        .user-btn {
            background: #1d3557;
            color: white;
            border: none;
            padding: 5px 15px;
            border-radius: 4px;
            cursor: pointer;
            margin-left: 10px;
            transition: background 0.3s;
        }

        .user-btn:hover {
            background: #2a5a8c;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --dark-bg: #0a0a0f;
            --darker-bg: #050508;
            --accent-red: #e63946;
            --accent-blue: #1d3557;
            --accent-gold: #fca311;
            --light-text: #f1faee;
            --gray-text: #a8a8a8;
            --card-bg: rgba(30, 30, 40, 0.8);
            --border-color: rgba(100, 100, 120, 0.3);
        }

        body {
            font-family: 'Roboto', 'Noto Serif SC', sans-serif;
            background: linear-gradient(135deg, var(--darker-bg) 0%, var(--dark-bg) 100%);
            color: var(--light-text);
            line-height: 1.6;
            overflow-x: hidden;
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* 页首视频 */
        .header-video {
            height: 60vh;
            position: relative;
            overflow: hidden;
            border-bottom: 1px solid var(--border-color);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            position: relative;
            overflow: hidden;
        }

        #war-video {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            min-width: 100%;
            min-height: 100%;
            width: auto;
            height: auto;
            object-fit: cover;
            filter: grayscale(30%) contrast(120%);
        }

        .video-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.6);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 2;
        }

        .header-title {
            font-size: 4rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 5px;
            text-align: center;
            margin-bottom: 1rem;
            text-shadow: 0 0 10px rgba(230, 57, 70, 0.7);
            animation: flicker 3s infinite alternate;
        }

        @keyframes flicker {

            0%,
            19%,
            21%,
            23%,
            25%,
            54%,
            56%,
            100% {
                text-shadow: 0 0 10px rgba(230, 57, 70, 0.7), 0 0 20px rgba(230, 57, 70, 0.5), 0 0 30px rgba(230, 57, 70, 0.3);
            }

            20%,
            24%,
            55% {
                text-shadow: none;
            }
        }

        .header-subtitle {
            font-size: 1.5rem;
            font-weight: 300;
            max-width: 700px;
            text-align: center;
            opacity: 0.9;
        }

        /* 主内容区 */
        .content-grid {
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: 30px;
            padding: 30px 0;
        }

        /* 侧边导航 */
        .sidebar {
            background: var(--card-bg);
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            position: sticky;
            top: 20px;
            max-height: 90vh;
            overflow-y: auto;
            scrollbar-width: thin;
            scrollbar-color: rgba(230, 57, 70, 0.3) transparent;
        }

        .sidebar::-webkit-scrollbar {
            width: 6px;
        }

        .sidebar::-webkit-scrollbar-track {
            background: transparent;
            border-radius: 10px;
        }

        .sidebar::-webkit-scrollbar-thumb {
            background: rgba(230, 57, 70, 0.3);
            border-radius: 10px;
            transition: background 0.3s ease;
        }

        .sidebar:hover::-webkit-scrollbar-thumb {
            background: rgba(230, 57, 70, 0.7);
        }

        .nav-category {
            margin-bottom: 30px;
        }

        .nav-title {
            font-size: 1.3rem;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--border-color);
            color: var(--accent-gold);
        }

        .timeline {
            list-style: none;
        }

        .timeline-item {
            padding: 10px 15px;
            margin-bottom: 8px;
            border-left: 3px solid var(--accent-red);
            background: rgba(230, 57, 70, 0.1);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .timeline-item:hover {
            background: rgba(230, 57, 70, 0.3);
            transform: translateX(5px);
        }

        .timeline-item.active {
            background: rgba(230, 57, 70, 0.3);
            border-left: 3px solid var(--accent-gold);
        }

        .timeline-year {
            font-weight: bold;
            font-size: 1.1rem;
        }

        .timeline-event {
            font-size: 0.9rem;
            opacity: 0.8;
        }

        /* 时间轴详情区域 */
        .timeline-detail {
            background: var(--card-bg);
            border-radius: 8px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            display: none;
        }

        .detail-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border-color);
        }

        .detail-title {
            font-size: 1.8rem;
            color: var(--accent-gold);
        }

        .detail-close {
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--gray-text);
            transition: color 0.3s;
        }

        .detail-close:hover {
            color: var(--accent-red);
        }

        .detail-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .detail-text {
            line-height: 1.8;
        }

        .detail-image {
            border-radius: 8px;
            overflow: hidden;
            height: 300px;
            background-size: cover;
            background-position: center;
        }

        .detail-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-top: 20px;
        }

        .stat-card {
            background: rgba(20, 20, 30, 0.6);
            border-radius: 8px;
            padding: 15px;
            border-left: 3px solid var(--accent-red);
        }

        .stat-value {
            font-size: 1.8rem;
            font-weight: bold;
            color: var(--accent-gold);
        }

        .stat-label {
            font-size: 0.9rem;
            opacity: 0.8;
        }

        /* 同时期战争卡片区域 */
        .contemporary-wars {
            margin-top: 30px;
        }

        .contemporary-title {
            font-size: 1.5rem;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--border-color);
            color: var(--accent-gold);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .contemporary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 25px;
            margin-top: 15px;
        }

        .more-wars {
            display: none;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 25px;
            margin-top: 15px;
        }

        .more-wars.active {
            display: grid;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .war-card {
            position: relative;
            height: 200px;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            transition: all 0.4s ease;
            cursor: pointer;
        }

        .war-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 30px rgba(230, 57, 70, 0.4);
        }

        .war-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.6);
            opacity: 0.7;
            transition: opacity 0.4s ease;
            z-index: 1;
        }

        .war-card:hover::before {
            opacity: 0.3;
        }

        .war-card-image {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.5s ease;
        }

        .war-card:hover .war-card-image {
            transform: scale(1.1);
        }

        .war-card-content {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            padding: 20px;
            z-index: 2;
            transition: all 0.4s ease;
            background: linear-gradient(transparent, rgba(0, 0, 0, 0.9));
        }

        .war-card:hover .war-card-content {
            height: 100%;
            background: rgba(10, 10, 15, 0.85);
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .war-card-title {
            font-size: 1.3rem;
            font-weight: bold;
            margin-bottom: 5px;
            color: white;
        }

        .war-card-period {
            font-size: 0.9rem;
            color: var(--accent-gold);
            margin-bottom: 10px;
        }

        .war-card-stats {
            display: none;
            font-size: 0.9rem;
            margin-top: 10px;
        }

        .war-card:hover .war-card-stats {
            display: block;
        }

        .war-card-description {
            display: none;
            margin-top: 15px;
            font-size: 0.9rem;
            line-height: 1.5;
        }

        .war-card:hover .war-card-description {
            display: block;
        }

        .war-card-link {
            display: none;
            margin-top: 15px;
            color: var(--accent-gold);
            font-weight: bold;
            text-decoration: none;
            transition: color 0.3s;
        }

        .war-card:hover .war-card-link {
            display: inline-block;
        }

        .war-card-link:hover {
            color: #ffcc00;
        }

        .show-more-btn {
            background: var(--accent-blue);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
        }

        .show-more-btn:hover {
            background: #2a5a8c;
            transform: translateY(-2px);
        }

        /* 主内容区 */
        .main-content {
            display: grid;
            grid-template-rows: auto auto auto auto;
        }

        /* 地图区域 */
        .map-section {
            height: 400px;
            background: var(--card-bg);
            border-radius: 8px;
            overflow: hidden;
            position: relative;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        #conflict-map {
            height: 100%;
            width: 100%;
            z-index: 1;
        }

        .map-overlay {
            position: absolute;
            bottom: 20px;
            left: 20px;
            z-index: 2;
            background: rgba(10, 10, 15, 0.8);
            padding: 10px 15px;
            border-radius: 5px;
        }

        .map-legend {
            display: flex;
            gap: 15px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 0.9rem;
        }

        .legend-color {
            width: 15px;
            height: 15px;
            border-radius: 50%;
        }

        .legend-red {
            background: var(--accent-red);
        }

        .legend-gray {
            background: var(--gray-text);
        }

        /* 数据可视化模块 */
        .data-visualization {
            background: var(--card-bg);
            border-radius: 8px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .chart-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 30px;
            margin-top: 20px;
        }

        .chart-container {
            height: 300px;
            background: rgba(20, 20, 30, 0.6);
            border-radius: 8px;
            padding: 15px;
        }

        .chart-title {
            font-size: 1.2rem;
            margin-bottom: 15px;
            text-align: center;
            color: var(--accent-gold);
        }

        /* 图表容器 */
        .chart {
            height: 100%;
            width: 100%;
        }

        /* 实时计数器 */
        .real-time-counter {
            background: rgba(230, 57, 70, 0.2);
            border: 1px solid var(--accent-red);
            border-radius: 8px;
            padding: 15px;
            margin-top: 20px;
            text-align: center;
        }

        .counter-title {
            font-size: 1.1rem;
            margin-bottom: 10px;
            color: var(--accent-gold);
        }

        .counter-value {
            font-size: 2.5rem;
            font-weight: bold;
            color: var(--accent-red);
            font-family: 'Courier New', monospace;
        }

        .counter-subtitle {
            font-size: 0.9rem;
            opacity: 0.8;
            margin-top: 5px;
        }

        /* 幸存者故事 */
        .survivor-stories {
            background: var(--card-bg);
            border-radius: 8px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .story-filters {
            display: flex;
            gap: 15px;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .filter-btn {
            padding: 8px 15px;
            background: rgba(100, 100, 120, 0.2);
            border: 1px solid var(--border-color);
            border-radius: 30px;
            color: var(--light-text);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .filter-btn:hover,
        .filter-btn.active {
            background: var(--accent-red);
        }

        .stories-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 25px;
            margin-top: 20px;
        }

        .story-card {
            background: rgba(20, 20, 30, 0.6);
            border-radius: 8px;
            overflow: hidden;
            transition: transform 0.3s ease;
            border: 1px solid var(--border-color);
        }

        .story-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        }

        .story-image {
            height: 200px;
            background-size: cover;
            background-position: center;
            position: relative;
        }

        .story-type {
            position: absolute;
            top: 15px;
            right: 15px;
            background: rgba(10, 10, 15, 0.8);
            padding: 5px 10px;
            border-radius: 30px;
            font-size: 0.8rem;
        }

        .soldier {
            color: #ff9f1c;
        }

        .civilian {
            color: #2a9d8f;
        }

        .child {
            color: #e9c46a;
        }

        .story-content {
            padding: 20px;
        }

        .story-quote {
            font-style: italic;
            margin-bottom: 15px;
            font-size: 1.1rem;
            line-height: 1.7;
        }

        .story-info {
            display: flex;
            justify-content: space-between;
            font-size: 0.9rem;
            opacity: 0.8;
        }

        .audio-control {
            color: var(--accent-gold);
            cursor: pointer;
        }

        /* 资源下载区 */
        .download-section {
            background: var(--card-bg);
            border-radius: 8px;
            padding: 30px;
            margin-top: 30px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .download-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 25px;
            margin-top: 20px;
        }

        .download-card {
            background: rgba(20, 20, 30, 0.6);
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            border: 1px solid var(--border-color);
            transition: all 0.3s ease;
        }

        .download-card:hover {
            transform: translateY(-5px);
            background: rgba(230, 57, 70, 0.1);
            border-color: var(--accent-red);
        }

        .download-icon {
            font-size: 3rem;
            margin-bottom: 15px;
            color: var(--accent-gold);
        }

        .download-title {
            font-size: 1.2rem;
            margin-bottom: 10px;
        }

        .download-desc {
            font-size: 0.9rem;
            opacity: 0.8;
            margin-bottom: 15px;
        }

        .download-btn {
            background: var(--accent-blue);
            color: white;
            padding: 8px 15px;
            border-radius: 5px;
            text-decoration: none;
            display: inline-block;
            transition: background 0.3s ease;
        }

        .download-btn:hover {
            background: #2a5a8c;
        }

        /* 页脚 */
        footer {
            text-align: center;
            padding: 30px 0;
            margin-top: 50px;
            border-top: 1px solid var(--border-color);
            font-size: 0.9rem;
            opacity: 0.7;
        }

        /* 数据加载控制 */
        .data-control {
            background: var(--card-bg);
            border-radius: 8px;
            padding: 15px;
            margin: 20px 0;
            text-align: center;
        }

        .reload-btn {
            background: var(--accent-blue);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            transition: background 0.3s;
            font-size: 1rem;
        }

        .reload-btn:hover {
            background: #2a5a8c;
        }

        .loading {
            color: var(--accent-gold);
            padding: 20px 0;
            text-align: center;
        }

        .loading-spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(252, 163, 17, 0.3);
            border-radius: 50%;
            border-top-color: var(--accent-gold);
            animation: spin 1s ease-in-out infinite;
            margin-right: 10px;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        /* 分析入口按钮 */
        .analytics-btn {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: var(--accent-gold);
            color: #000;
            border: none;
            padding: 12px 25px;
            border-radius: 50px;
            cursor: pointer;
            font-size: 1.1rem;
            font-weight: 600;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            z-index: 1000;
        }

        .analytics-btn:hover {
            background: #e69500;
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.4);
        }

        /* 响应式设计 */
        @media (max-width: 1200px) {
            .chart-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 992px) {
            .content-grid {
                grid-template-columns: 1fr;
            }

            .sidebar {
                position: relative;
                top: 0;
            }

            .header-title {
                font-size: 2.5rem;
            }

            .detail-content {
                grid-template-columns: 1fr;
            }

            .contemporary-grid,
            .more-wars {
                grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            }
        }

        @media (max-width: 768px) {
            .header-title {
                font-size: 2rem;
            }

            .header-subtitle {
                font-size: 1.2rem;
            }

            .stories-grid {
                grid-template-columns: 1fr;
            }

            .contemporary-grid,
            .more-wars {
                grid-template-columns: 1fr;
            }

            .analytics-btn {
                bottom: 15px;
                right: 15px;
                padding: 10px 20px;
                font-size: 1rem;
            }
        }

        /* 新增通知样式 */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(41, 128, 185, 0.9);
            color: white;
            padding: 15px 25px;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            z-index: 1000;
            animation: slideIn 0.3s, fadeOut 0.5s 2.5s;
        }

        @keyframes slideIn {
            from {
                transform: translateX(100px);
                opacity: 0;
            }

            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        @keyframes fadeOut {
            from {
                opacity: 1;
            }

            to {
                opacity: 0;
            }
        }

        /* 返回顶部按钮样式 */
        .back-to-top {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 1000;
        }

        .back-to-top-link {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: rgba(252, 163, 17, 0.9);
            color: #fff;
            text-decoration: none;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            transition: all 0.3s ease;
        }

        .back-to-top-link:hover {
            background: #e69500;
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.4);
        }

        #username-display.text-peace-blue {
            color: white !important;
            /* 修改为你想要的颜色 */
        }

        a {
            text-decoration: none;
        }
    </style>
</head>

<body>
    <!-- 页首视频 -->
    <div class="header-video" id="top">
        <video id="war-video" autoplay muted loop>
            <source src="sp.mp4" type="video/mp4">
            您的浏览器不支持HTML5视频
        </video>
        <div class="video-overlay">
            <h1 class="header-title">战争真相</h1>
            <p class="header-subtitle">沉浸式数据叙事 - 探索战争的成本与和平的价值</p>
        </div>
    </div>

    <!-- 在用户信息栏中添加返回首页按钮 -->
    <div class="user-bar">
        <div class="container">
            <div id="user-info" style="text-align: right; padding: 10px;">
                                <a href="gerenzhongxin_xgawy.html" id="username-display"
                    class="text-peace-blue font-medium mr-2 hover:underline"></a>
                <!-- 添加返回首页按钮 -->
                <a href="shouye2.0_xgawy.html" id="home-btn" class="user-btn">返回首页</a>
                <button id="login-btn" class="user-btn">登录</button>
                <button id="logout-btn" class="user-btn" style="display:none">退出</button>
            </div>
        </div>
    </div>

    <div class="container">
        <div class="data-control">
            <div class="loading" id="loading-indicator">
                <span class="loading-spinner"></span> 正在加载数据...
            </div>
            <p><button class="reload-btn" id="reload-data"><i class="fas fa-sync-alt"></i></button>
            </p>
        </div>

        <div class="content-grid">
            <!-- 左侧导航 -->
            <div class="sidebar">
                <div class="nav-category">
                    <h2 class="nav-title">时间轴导航</h2>
                    <ul class="timeline" id="timeline-container">
                        <!-- 时间轴项目将由JS动态生成 -->
                    </ul>
                </div>

                <div class="nav-category">
                    <h2 class="nav-title">数据对比</h2>
                    <div class="comparison-mini">
                        <div class="data-item">
                            <div class="data-label"><i class="fas fa-money-bill-wave"></i> 全球军费支出</div>
                            <div class="data-value" id="military-spending">$2.24万亿</div>
                        </div>
                        <div class="data-item">
                            <div class="data-label"><i class="fas fa-book"></i> 全球教育支出</div>
                            <div class="data-value" id="education-spending">$4.8万亿</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 主内容区 -->
            <div class="main-content">
                <!-- 时间轴详情区域 -->
                <div class="timeline-detail" id="timeline-detail">
                    <div class="detail-header">
                        <h2 class="detail-title" id="detail-title">事件详情</h2>
                        <div class="detail-close" id="detail-close"><i class="fas fa-times"></i></div>
                    </div>
                    <div class="detail-content">
                        <div class="detail-text" id="detail-text">
                            <p>选择一个时间轴事件以查看详情...</p>
                        </div>
                        <div class="detail-image" id="detail-image"></div>
                    </div>
                    <div class="detail-stats" id="detail-stats">
                        <!-- 统计信息会动态添加 -->
                    </div>

                    <!-- 同时期战争卡片区域 -->
                    <div class="contemporary-wars">
                        <h3 class="contemporary-title">
                            <i class="fas fa-folder-open"></i> 同时期其他战争
                            <button class="show-more-btn" id="show-more-btn">
                                <i class="fas fa-chevron-down"></i> 查看更多同时期战争
                            </button>
                        </h3>
                        <div class="contemporary-grid" id="contemporary-container">
                            <!-- 同时期战争卡片将由JS动态生成 -->
                        </div>
                        <div class="more-wars" id="more-wars-container">
                            <!-- 更多战争卡片将由JS动态生成 -->
                        </div>
                    </div>
                </div>
                <h1>冲突区与战争遗址地图</h1>
                <!-- 地图区域 -->
                <div class="map-section">
                    <div id="conflict-map"></div>
                    <div class="map-overlay">
                        <div class="map-legend">
                            <div class="legend-item">
                                <div class="legend-color legend-red"></div>
                                <span>当前冲突区</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color legend-gray"></div>
                                <span>历史战争遗址</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 数据可视化模块 -->
                <div class="data-visualization">
                    <h2 class="nav-title"><i class="fas fa-chart-line"></i> 战争数据深度分析</h2>

                    <div class="chart-grid">
                        <div class="chart-container">
                            <div class="chart-title">全球军费开支趋势（1945-2023）</div>
                            <div id="military-spending-chart" class="chart"></div>
                        </div>
                        <div class="chart-container">
                            <div class="chart-title">战争死亡人数分布</div>
                            <div id="death-distribution-chart" class="chart"></div>
                        </div>
                        <div class="chart-container">
                            <div class="chart-title">战争成本与和平效益对比</div>
                            <div id="cost-benefit-chart" class="chart"></div>
                        </div>
                        <div class="chart-container">
                            <div class="chart-title">主要冲突地区军费占比</div>
                            <div id="region-spending-chart" class="chart"></div>
                        </div>
                        <div class="chart-container">
                            <div class="chart-title">战争持续时间对比</div>
                            <div id="war-duration-chart" class="chart"></div>
                        </div>
                        <div class="chart-container">
                            <div class="chart-title">战争经济损失对比</div>
                            <div id="economic-loss-chart" class="chart"></div>
                        </div>
                        <div class="chart-container">
                            <div class="chart-title">战后难民人数</div>
                            <div id="refugee-chart" class="chart"></div>
                        </div>
                        <div class="chart-container">
                            <div class="chart-title">冲突地区分布</div>
                            <div id="conflict-region-chart" class="chart"></div>
                        </div>
                    </div>
                    <br> <br> <br> <br>
                    <!-- 受难人数实时动态 -->
                    <div class="real-time-counter">
                        <div class="counter-title"><i class="fas fa-skull"></i> 全球冲突直接死亡人数</div>
                        <div class="counter-value" id="casualty-counter">0</div>
                        <div class="counter-subtitle">自2001年以来的累计数字 (每分钟更新)</div>
                    </div>
                </div>

                <!-- 幸存者故事 -->
                <div class="survivor-stories">
                    <h2 class="nav-title"><i class="fas fa-history"></i> 幸存者故事</h2>
                    <div class="story-filters">
                        <button class="filter-btn active" data-type="all">全部</button>
                        <button class="filter-btn" data-type="soldier"><i class="fas fa-helmet-battle"></i> 士兵</button>
                        <button class="filter-btn" data-type="civilian"><i class="fas fa-user"></i> 平民</button>
                        <button class="filter-btn" data-type="child"><i class="fas fa-child"></i> 儿童</button>
                    </div>

                    <div class="stories-grid" id="stories-container">
                        <!-- 故事卡片将由JS动态生成 -->
                    </div>
                </div>
            </div>
        </div>

        <!-- 资源下载区 -->
        <div class="download-section">
            <h2 class="nav-title"><i class="fas fa-download"></i> 资源下载</h2>
            <div class="download-grid">
                <div class="download-card">
                    <div class="download-icon"><i class="fas fa-file-pdf"></i></div>
                    <h3 class="download-title">年度战争报告</h3>
                    <p class="download-desc">2023年全球冲突与和平建设综合分析</p>
                    <a href="#" class="download-btn">下载 PDF</a>
                </div>

                <div class="download-card">
                    <div class="download-icon"><i class="fas fa-chart-bar"></i></div>
                    <h3 class="download-title">数据图包</h3>
                    <p class="download-desc">战争成本与和平效益的可视化数据图表</p>
                    <a href="#" class="download-btn">下载 ZIP</a>
                </div>

                <div class="download-card">
                    <div class="download-icon"><i class="fas fa-chalkboard-teacher"></i></div>
                    <h3 class="download-title">教学PPT</h3>
                    <p class="download-desc">战争与和平主题的教育演示文稿</p>
                    <a href="#" class="download-btn">下载 PPTX</a>
                </div>

                <div class="download-card">
                    <div class="download-icon"><i class="fas fa-palette"></i></div>
                    <h3 class="download-title">海报模板</h3>
                    <p class="download-desc">和平倡导活动的设计模板</p>
                    <a href="#" class="download-btn">下载 PSD</a>
                </div>
            </div>
        </div>
    </div>
    <!-- 放在footer之后 -->
    <div class="back-to-top">
        <a href="#top" class="back-to-top-link">
            <i class="fas fa-arrow-up"></i>
        </a>
    </div>
    <script>
        // 定义用户行为类型
        const BEHAVIOR_TYPES = {
            // 核心内容交互行为
            TIMELINE_CLICK: '时间轴事件点击',
            DETAIL_OPEN: '事件详情面板查看',
            DETAIL_CLOSE: '事件详情面板关闭',
            WAR_CARD_EXPLORE: '同时期战争卡片探索',
            CHART_INTERACTION: '图表数据探索',
            COUNTER_VIEW: '全球冲突死亡实时计数器关注',

            // 情感化内容参与
            STORY_FILTER: '幸存者故事分类筛选',
            AUDIO_PLAY: '音频内容播放请求',
            STORY_READ: '幸存者故事阅读',

            // 资源获取行为
            DOWNLOAD_PDF: 'PDF报告下载',
            DOWNLOAD_DATA: '数据包下载',
            DOWNLOAD_PPT: '教学PPT下载',
            DOWNLOAD_TEMPLATE: '设计模板下载',

            // 地图与时空探索
            MAP_MARKER_CLICK: '冲突标记点击'
        };

        // 初始化行为记录数组
        let userBehaviors = [];

        // 获取当前用户ID（修复未定义错误）
        // 替换原有的getCurrentUserId函数
        function getCurrentUserId() {
            const user = JSON.parse(localStorage.getItem('currentUser'));
            return user ? user.id : null;
        }

        // 从localStorage加载行为记录
        function loadBehaviors() {
            const userId = getCurrentUserId();
            if (!userId) {
                console.log('用户未登录，不加载行为数据');
                return;
            }

            const savedBehaviors = localStorage.getItem(`warTruthBehaviors_${userId}`);
            if (savedBehaviors) {
                userBehaviors = JSON.parse(savedBehaviors);
            }
        }

        // 保存行为记录到localStorage
        function saveBehaviors() {
            const userId = getCurrentUserId();
            if (!userId) {
                console.log('用户未登录，行为数据不保存');
                return;
            }

            localStorage.setItem(`warTruthBehaviors_${userId}`, JSON.stringify(userBehaviors));
        }

        // 记录用户行为
        function recordBehavior(type, details = {}) {
            const behavior = {
                type,
                details,
                timestamp: new Date().toISOString()
            };

            userBehaviors.push(behavior);
            saveBehaviors();
            // showNotification(`已记录: ${type}`);
        }

        // 显示通知
        function showNotification(message) {
            const notification = document.createElement('div');
            notification.className = 'notification';
            notification.textContent = message;
            document.body.appendChild(notification);

            setTimeout(() => {
                if (notification.parentNode) {
                    document.body.removeChild(notification);
                }
            }, 3000);
        }

        // 全局变量存储应用数据
        let appData = null;

        // 从外部JSON文件加载数据
        async function loadData() {
            try {
                const loadingIndicator = document.getElementById('loading-indicator');
                loadingIndicator.style.display = 'block';

                // 加载外部JSON数据
                const response = await fetch('wardata.json');
                if (!response.ok) {
                    throw new Error('网络响应异常');
                }
                appData = await response.json();

                // 检查 ECharts 对象是否已定义
                if (typeof echarts === 'undefined') {
                    throw new Error('ECharts 未正确加载');
                }

                // 更新全局数据
                document.getElementById('military-spending').textContent = appData.global.militarySpending;
                document.getElementById('education-spending').textContent = appData.global.educationSpending;

                // 渲染时间轴
                renderTimeline();

                // 渲染幸存者故事
                renderStories();

                // 初始化图表
                initCharts();

                // 初始化地图
                initMap();

                // 隐藏加载指示器
                loadingIndicator.style.display = 'none';

                // 默认显示一个详情
                showTimelineDetail('ukraine-war');
                document.querySelector('.timeline-item[data-period="ukraine-war"]').classList.add('active');

            } catch (error) {
                console.error('加载数据失败:', error);
                const loadingIndicator = document.getElementById('loading-indicator');
                loadingIndicator.innerHTML =
                    `<div style="color: var(--accent-red);">
                        <i class="fas fa-exclamation-triangle"></i> 数据加载失败: ${error.message}
                    </div>`;
            }
        }

        // 渲染时间轴
        function renderTimeline() {
            const container = document.getElementById('timeline-container');
            container.innerHTML = '';

            appData.timelineEvents.forEach(event => {
                const li = document.createElement('li');
                li.className = 'timeline-item';
                li.dataset.period = event.id;

                li.innerHTML = `
                    <div class="timeline-year">${event.year}</div>
                    <div class="timeline-event">${event.name}</div>
                `;

                li.addEventListener('click', function () {
                    document.querySelectorAll('.timeline-item').forEach(i => i.classList.remove('active'));
                    this.classList.add('active');
                    showTimelineDetail(event.id);

                    // 记录行为：点击时间轴事件
                    recordBehavior(BEHAVIOR_TYPES.TIMELINE_CLICK, {
                        event: event.name
                    });
                });

                container.appendChild(li);
            });
        }

        // 初始化地图
        function initMap() {
            const map = L.map('conflict-map').setView([30, 10], 2);

            L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {
                attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
            }).addTo(map);

            const currentConflicts = [
                {
                    lat: 48.3794, lng: 31.1656, title: '乌克兰战争', desc: '2022年2月爆发'
                },
                {
                    lat: 33.9391, lng: 67.7100, title: '阿富汗冲突', desc: '持续冲突'
                },
                {
                    lat: 12.8628, lng: 30.2176, title: '苏丹内战', desc: '2023年爆发'
                },
                {
                    lat: 17.5707, lng: -3.9962, title: '马里冲突', desc: '持续冲突'
                },
                {
                    lat: 31.0461, lng: 34.8516, title: '巴以冲突', desc: '持续冲突'
                },
                // 新增的当前冲突区
                {
                    lat: 15.5527, lng: 48.5164, title: '也门内战', desc: '2014年爆发'
                },
                {
                    lat: 21.9162, lng: 95.9560, title: '缅甸内战', desc: '2021年爆发'
                },
                {
                    lat: 9.1450, lng: 40.4897, title: '埃塞俄比亚内战', desc: '2020年爆发'
                },
                {
                    lat: 5.1521, lng: 46.1996, title: '索马里冲突', desc: '持续冲突'
                },
                {
                    lat: 12.2383, lng: -1.5616, title: '萨赫勒地区冲突', desc: '持续冲突'
                }
            ];

            currentConflicts.forEach(conflict => {
                const marker = L.circleMarker([conflict.lat, conflict.lng], {
                    color: '#e63946',
                    fillColor: '#e63946',
                    fillOpacity: 0.7,
                    radius: 8
                }).addTo(map)
                    .bindPopup(`<b>${conflict.title}</b><br>${conflict.desc}`);

                marker.on('click', function () {
                    recordBehavior(BEHAVIOR_TYPES.MAP_MARKER_CLICK, {
                        markerName: conflict.title,
                        markerType: 'current'
                    });
                });
            });

            // 添加历史战争遗址标记（灰色）
            const historicalConflicts = [
                {
                    lat: 52.2297, lng: 21.0122, title: '华沙起义', desc: '1944年'
                },
                {
                    lat: 39.9042, lng: 116.4074, title: '抗日战争', desc: '1937-1945'
                },
                {
                    lat: 33.3152, lng: 44.3661, title: '伊拉克战争', desc: '2003-2011'
                },
                {
                    lat: 34.5333, lng: 69.1333, title: '阿富汗战争', desc: '2001-2021'
                },
                {
                    lat: 10.8231, lng: 106.6297, title: '越南战争', desc: '1955-1975'
                },
                // 新增的历史战争遗址
                {
                    lat: 49.4144, lng: -1.3167, title: '诺曼底登陆', desc: '1944年'
                },
                {
                    lat: 48.7080, lng: 44.5133, title: '斯大林格勒战役', desc: '1942-1943'
                },
                {
                    lat: 34.3928, lng: 132.4597, title: '广岛原爆', desc: '1945年'
                },
                {
                    lat: 21.3667, lng: -157.9500, title: '珍珠港事件', desc: '1941年'
                },
                {
                    lat: 52.5200, lng: 13.4050, title: '柏林战役', desc: '1945年'
                }
            ];

            historicalConflicts.forEach(conflict => {
                const marker = L.circleMarker([conflict.lat, conflict.lng], {
                    color: '#a8a8a8',
                    fillColor: '#a8a8a8',
                    fillOpacity: 0.7,
                    radius: 8
                }).addTo(map)
                    .bindPopup(`<b>${conflict.title}</b><br>${conflict.desc}`);

                marker.on('click', function () {
                    recordBehavior(BEHAVIOR_TYPES.MAP_MARKER_CLICK, {
                        markerName: conflict.title,
                        markerType: 'historical'
                    });
                });
            });
        }

        // 初始化图表
        function initCharts() {
            const chartNameMap = new Map([
                [document.getElementById('military-spending-chart'), '全球军费开支趋势'],
                [document.getElementById('death-distribution-chart'), '战争死亡人数分布'],
                [document.getElementById('cost-benefit-chart'), '战争成本与和平效益对比'],
                [document.getElementById('region-spending-chart'), '主要冲突地区军费占比'],
                [document.getElementById('war-duration-chart'), '战争持续时间对比'],
                [document.getElementById('economic-loss-chart'), '战争经济损失对比'],
                [document.getElementById('refugee-chart'), '战后难民人数'],
                [document.getElementById('conflict-region-chart'), '冲突地区分布']
            ]);
            // 全球军费开支趋势图 - 折线图
            const militaryChart = echarts.init(document.getElementById('military-spending-chart'));
            militaryChart.setOption({
                backgroundColor: 'transparent',
                tooltip: {
                    trigger: 'axis',
                    formatter: '{b}: {c} 万亿美元'
                },
                grid: {
                    top: '15%',
                    left: '10%',
                    right: '10%',
                    bottom: '15%'
                },
                xAxis: {
                    type: 'category',
                    data: ['1945', '1950', '1960', '1970', '1980', '1990', '2000', '2010', '2023'],
                    axisLine: {
                        lineStyle: {
                            color: '#a8a8a8'
                        }
                    }
                },
                yAxis: {
                    type: 'value',
                    name: '万亿美元',
                    axisLine: {
                        lineStyle: {
                            color: '#a8a8a8'
                        }
                    },
                    splitLine: {
                        lineStyle: {
                            color: 'rgba(168, 168, 168, 0.1)'
                        }
                    }
                },
                series: [{
                    name: '全球军费开支',
                    type: 'line',
                    smooth: true,
                    symbol: 'circle',
                    symbolSize: 8,
                    data: [0.2, 0.5, 0.9, 1.2, 1.8, 1.1, 1.5, 1.8, 2.24],
                    lineStyle: {
                        color: '#e63946',
                        width: 3
                    },
                    itemStyle: {
                        color: '#e63946'
                    },
                    areaStyle: {
                        color: {
                            type: 'linear',
                            x: 0,
                            y: 0,
                            x2: 0,
                            y2: 1,
                            colorStops: [{
                                offset: 0,
                                color: 'rgba(230, 57, 70, 0.3)'
                            }, {
                                offset: 1,
                                color: 'rgba(230, 57, 70, 0.01)'
                            }]
                        }
                    }
                }]
            });

            // 死亡人数分布图 - 饼图
            const deathChart = echarts.init(document.getElementById('death-distribution-chart'));
            deathChart.setOption({
                backgroundColor: 'transparent',
                tooltip: {
                    trigger: 'item',
                    formatter: '{b}: {c} ({d}%)'
                },
                legend: {
                    orient: 'horizontal',
                    bottom: 0,
                    textStyle: {
                        color: '#f1faee'
                    }
                },
                series: [{
                    name: '死亡人数分布',
                    type: 'pie',
                    radius: ['40%', '70%'],
                    itemStyle: {
                        borderRadius: 10,
                        borderColor: 'rgba(0, 0, 0, 0.5)',
                        borderWidth: 2
                    },
                    label: {
                        show: true,
                        formatter: '{b}: {c}'
                    },
                    data: [{
                        value: 30,
                        name: '士兵',
                        itemStyle: {
                            color: '#e63946'
                        }
                    }, {
                        value: 50,
                        name: '平民',
                        itemStyle: {
                            color: '#fca311'
                        }
                    }, {
                        value: 20,
                        name: '儿童',
                        itemStyle: {
                            color: '#e9c46a'
                        }
                    }]
                }]
            });

            // 成本效益对比图 - 柱状图
            const costChart = echarts.init(document.getElementById('cost-benefit-chart'));
            costChart.setOption({
                backgroundColor: 'transparent',
                tooltip: {
                    trigger: 'axis',
                    axisPointer: {
                        type: 'shadow'
                    }
                },
                legend: {
                    data: ['战争成本', '和平效益'],
                    textStyle: {
                        color: '#f1faee'
                    },
                    top: 10
                },
                grid: {
                    top: '20%',
                    left: '3%',
                    right: '4%',
                    bottom: '3%',
                    containLabel: true
                },
                xAxis: {
                    type: 'category',
                    data: ['经济成本', '生命损失', '难民数量', '环境破坏', '教育损失'],
                    axisLine: {
                        lineStyle: {
                            color: '#a8a8a8'
                        }
                    }
                },
                yAxis: {
                    type: 'value',
                    name: '损失程度（指数）',
                    axisLine: {
                        lineStyle: {
                            color: '#a8a8a8'
                        }
                    },
                    splitLine: {
                        lineStyle: {
                            color: 'rgba(168, 168, 168, 0.1)'
                        }
                    }
                },
                series: [{
                    name: '战争成本',
                    type: 'bar',
                    barWidth: '40%',
                    data: [14.5, 0.94, 103, 5, 0.45],
                    itemStyle: {
                        color: '#e63946'
                    }
                }, {
                    name: '和平效益',
                    type: 'bar',
                    barWidth: '40%',
                    data: [0, 0, 0, 0, 4.8],
                    itemStyle: {
                        color: '#1d3557'
                    }
                }]
            });

            // 地区军费占比图 - 雷达图
            const regionChart = echarts.init(document.getElementById('region-spending-chart'));
            regionChart.setOption({
                backgroundColor: 'transparent',
                tooltip: {
                    trigger: 'item',
                    formatter: '{b}: {c}%'
                },
                radar: {
                    indicator: [{
                        name: '北美',
                        max: 100
                    }, {
                        name: '欧洲',
                        max: 100
                    }, {
                        name: '亚洲',
                        max: 100
                    }, {
                        name: '中东',
                        max: 100
                    }, {
                        name: '非洲',
                        max: 100
                    }],
                    radius: '70%',
                    splitArea: {
                        areaStyle: {
                            color: ['rgba(168, 168, 168, 0.1)']
                        }
                    },
                    axisLine: {
                        lineStyle: {
                            color: 'rgba(168, 168, 168, 0.5)'
                        }
                    },
                    splitLine: {
                        lineStyle: {
                            color: 'rgba(168, 168, 168, 0.5)'
                        }
                    }
                },
                series: [{
                    type: 'radar',
                    data: [{
                        value: [30, 25, 20, 15, 10],
                        name: '军费占比',
                        areaStyle: {
                            color: 'rgba(230, 57, 70, 0.2)'
                        },
                        lineStyle: {
                            color: '#e63946',
                            width: 2
                        },
                        itemStyle: {
                            color: '#e63946'
                        },
                        label: {
                            show: true,
                            formatter: '{c}%'
                        }
                    }]
                }]
            });

            // 战争持续时间对比 - 柱状图
            const durationChart = echarts.init(document.getElementById('war-duration-chart'));
            durationChart.setOption({
                backgroundColor: 'transparent',
                tooltip: {
                    trigger: 'axis',
                    formatter: '{b}: {c} 年'
                },
                grid: {
                    top: '15%',
                    left: '15%',
                    right: '10%',
                    bottom: '15%'
                },
                xAxis: {
                    type: 'category',
                    data: ['二战', '朝鲜战争', '越南战争', '海湾战争', '阿富汗战争', '伊拉克战争', '俄乌冲突'],
                    axisLine: {
                        lineStyle: {
                            color: '#a8a8a8'
                        }
                    },
                    axisLabel: {
                        interval: 0,
                        rotate: 30
                    }
                },
                yAxis: {
                    type: 'value',
                    name: '年',
                    axisLine: {
                        lineStyle: {
                            color: '#a8a8a8'
                        }
                    },
                    splitLine: {
                        lineStyle: {
                            color: 'rgba(168, 168, 168, 0.1)'
                        }
                    }
                },
                series: [{
                    name: '持续时间',
                    type: 'bar',
                    barWidth: '60%',
                    data: [6, 3, 20, 1, 20, 8, 3],
                    itemStyle: {
                        color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [{
                            offset: 0,
                            color: '#fca311'
                        }, {
                            offset: 1,
                            color: '#e63946'
                        }])
                    }
                }]
            });

            // 战争经济损失对比 - 柱状图
            const economicChart = echarts.init(document.getElementById('economic-loss-chart'));
            economicChart.setOption({
                backgroundColor: 'transparent',
                tooltip: {
                    trigger: 'axis',
                    formatter: '{b}: {c} 万亿美元'
                },
                grid: {
                    top: '15%',
                    left: '15%',
                    right: '10%',
                    bottom: '15%'
                },
                xAxis: {
                    type: 'category',
                    data: ['二战', '朝鲜战争', '越南战争', '海湾战争', '阿富汗战争', '伊拉克战争', '俄乌冲突'],
                    axisLine: {
                        lineStyle: {
                            color: '#a8a8a8'
                        }
                    },
                    axisLabel: {
                        interval: 0,
                        rotate: 30
                    }
                },
                yAxis: {
                    type: 'value',
                    name: '万亿美元',
                    axisLine: {
                        lineStyle: {
                            color: '#a8a8a8'
                        }
                    },
                    splitLine: {
                        lineStyle: {
                            color: 'rgba(168, 168, 168, 0.1)'
                        }
                    }
                },
                series: [{
                    name: '经济损失',
                    type: 'bar',
                    barWidth: '60%',
                    data: [30, 0.3, 0.77, 0.1, 2.26, 1.7, 1.0],
                    itemStyle: {
                        color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [{
                            offset: 0,
                            color: '#e63946'
                        }, {
                            offset: 1,
                            color: '#1d3557'
                        }])
                    }
                }]
            });

            // 战后难民人数 - 南丁格尔图
            const refugeeChart = echarts.init(document.getElementById('refugee-chart'));
            refugeeChart.setOption({
                backgroundColor: 'transparent',
                tooltip: {
                    trigger: 'item',
                    formatter: '{b}: {c} 百万'
                },
                legend: {
                    orient: 'horizontal',
                    bottom: 0,
                    textStyle: {
                        color: '#f1faee'
                    }
                },
                series: [{
                    name: '难民人数',
                    type: 'pie',
                    radius: '70%',
                    roseType: 'area',
                    itemStyle: {
                        borderRadius: 8
                    },
                    label: {
                        formatter: '{b}: {c}百万'
                    },
                    data: [{
                        value: 60,
                        name: '二战',
                        itemStyle: {
                            color: '#e63946'
                        }
                    }, {
                        value: 5,
                        name: '朝鲜战争',
                        itemStyle: {
                            color: '#fca311'
                        }
                    }, {
                        value: 3,
                        name: '越南战争',
                        itemStyle: {
                            color: '#e9c46a'
                        }
                    }, {
                        value: 5,
                        name: '海湾战争',
                        itemStyle: {
                            color: '#2a9d8f'
                        }
                    }, {
                        value: 38,
                        name: '阿富汗战争',
                        itemStyle: {
                            color: '#1d3557'
                        }
                    }, {
                        value: 9,
                        name: '伊拉克战争',
                        itemStyle: {
                            color: '#a8dadc'
                        }
                    }, {
                        value: 10,
                        name: '俄乌冲突',
                        itemStyle: {
                            color: '#f4a261'
                        }
                    }]
                }]
            });

            // 冲突地区分布 - 南丁格尔图
            const regionConflictChart = echarts.init(document.getElementById('conflict-region-chart'));
            regionConflictChart.setOption({
                backgroundColor: 'transparent',
                tooltip: {
                    trigger: 'item',
                    formatter: '{b}: {c}%'
                },
                series: [{
                    name: '冲突地区分布',
                    type: 'pie',
                    radius: ['30%', '80%'],
                    roseType: 'area',
                    itemStyle: {
                        borderRadius: 8
                    },
                    label: {
                        formatter: '{b}: {c}%'
                    },
                    data: [{
                        value: 35,
                        name: '中东',
                        itemStyle: {
                            color: '#e63946'
                        }
                    }, {
                        value: 25,
                        name: '非洲',
                        itemStyle: {
                            color: '#fca311'
                        }
                    }, {
                        value: 20,
                        name: '亚洲',
                        itemStyle: {
                            color: '#e9c46a'
                        }
                    }, {
                        value: 10,
                        name: '欧洲',
                        itemStyle: {
                            color: '#2a9d8f'
                        }
                    }, {
                        value: 5,
                        name: '美洲',
                        itemStyle: {
                            color: '#1d3557'
                        }
                    }, {
                        value: 5,
                        name: '其他',
                        itemStyle: {
                            color: '#a8dadc'
                        }
                    }]
                }]
            });

            // 图表点击事件
            const charts = [
                militaryChart, deathChart, costChart, regionChart,
                durationChart, economicChart, refugeeChart, regionConflictChart
            ];

            charts.forEach(chart => {
                const chartElement = chart.getDom();
                const chartName = chartNameMap.get(chartElement) || '未知图表';

                chart.on('click', function () {
                    recordBehavior(BEHAVIOR_TYPES.CHART_INTERACTION, {
                        chart: chartName,
                        id: chartElement.id
                    });
                });
            });
        }

        // 显示时间轴详情
        function showTimelineDetail(id) {
            const eventData = appData.timelineDetails[id];
            document.getElementById('detail-title').textContent = eventData.title;
            document.getElementById('detail-text').innerHTML = eventData.text;
            document.getElementById('detail-image').style.backgroundImage = `url('${eventData.image}')`;

            const statsContainer = document.getElementById('detail-stats');
            statsContainer.innerHTML = '';

            eventData.stats.forEach(stat => {
                const statCard = document.createElement('div');
                statCard.className = 'stat-card';
                statCard.innerHTML = `
                    <div class="stat-value">${stat.value}</div>
                    <div class="stat-label">${stat.label}</div>
                `;
                statsContainer.appendChild(statCard);
            });

            // 渲染同时期战争卡片
            renderContemporaryWars(id);

            document.getElementById('timeline-detail').style.display = 'block';

            // 记录行为：打开详情面板
            recordBehavior(BEHAVIOR_TYPES.DETAIL_OPEN, {
                event: eventData.title
            });
        }

        // 渲染同时期战争卡片
        function renderContemporaryWars(id) {
            const container = document.getElementById('contemporary-container');
            container.innerHTML = '';

            const moreContainer = document.getElementById('more-wars-container');
            moreContainer.innerHTML = '';
            moreContainer.classList.remove('active');

            // 获取当前战争的同时期战争数据
            const wars = appData.contemporaryWars[id] || appData.contemporaryWars['default'];

            // 初始显示4个战争
            const initialWars = wars.slice(0, 6);
            const moreWars = wars.slice(6);

            // 渲染初始战争
            initialWars.forEach(war => {
                container.appendChild(createWarCard(war));
            });

            // 渲染更多战争
            moreWars.forEach(war => {
                moreContainer.appendChild(createWarCard(war));
            });

            // 更新按钮文本
            const moreBtn = document.getElementById('show-more-btn');
            if (moreWars.length > 0) {
                moreBtn.style.display = 'flex';
                moreBtn.innerHTML = `<i class="fas fa-chevron-down"></i> 查看更多同时期战争 (${moreWars.length})`;
            } else {
                moreBtn.style.display = 'none';
            }
        }

        // 创建战争卡片
        function createWarCard(war) {
            const card = document.createElement('div');
            card.className = 'war-card';
            card.innerHTML = `
                <img src="${war.image}" alt="${war.title}" class="war-card-image">
                <div class="war-card-content">
                    <div class="war-card-title">${war.title}</div>
                    <div class="war-card-period">${war.period}</div>
                    <div class="war-card-stats">${war.stats}</div>
                    <div class="war-card-description">${war.description}</div>
                    <a href="#" class="war-card-link">查看详情 <i class="fas fa-arrow-right"></i></a>
                </div>
            `;

            // 点击卡片查看详情
            card.addEventListener('click', function (event) {
                // 防止链接的默认行为
                if (event.target.closest('.war-card-link')) {
                    event.preventDefault();
                }

                // 记录行为：探索战争卡片
                recordBehavior(BEHAVIOR_TYPES.WAR_CARD_EXPLORE, {
                    war: war.title,
                    period: war.period,
                    id: war.id
                });
                //跳转详情页
                localStorage.setItem('selectedWar', war.title);
                window.location.href = 'zhanzhengxiangqing_xgawy.html';
                // 如果是太平洋战争卡片，跳转到详情页
                if (war.id === '                  ') {
                    window.location.href = 'pacific_war.html';
                } else {
                    // 显示通知
                    showNotification(`探索战争: ${war.title}`);
                }
            });

            return card;
        }

        // 渲染幸存者故事
        function renderStories(type = 'all') {
            const container = document.getElementById('stories-container');
            container.innerHTML = '';

            let stories = [];
            if (type === 'all') {
                stories = appData.survivorStories.all;
            } else {
                stories = appData.survivorStories[type];
            }

            stories.forEach(story => {
                const card = document.createElement('div');
                card.className = 'story-card';

                let typeClass = '';
                let typeText = '';

                switch (story.type) {
                    case 'soldier':
                        typeClass = 'soldier';
                        typeText = '退伍军人';
                        break;
                    case 'civilian':
                        typeClass = 'civilian';
                        typeText = '平民幸存者';
                        break;
                    case 'child':
                        typeClass = 'child';
                        typeText = '战争儿童';
                        break;
                }

                card.innerHTML = `
                    <div class="story-image" style="background-image: linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.3)), url('${story.image}');">
                        <span class="story-type ${typeClass}">${typeText}</span>
                    </div>
                    <div class="story-content">
                        <p class="story-quote">"${story.quote}"</p>
                        <div class="story-info">
                            <span>${story.name} | ${story.period}</span>
                            <span class="audio-control"><i class="fas fa-play-circle"></i> 播放声音</span>
                        </div>
                    </div>
                `;

                container.appendChild(card);
            });
        }

        function initCasualtyCounter() {
            const counter = document.getElementById('casualty-counter');
            // 初始值基于2001年以来的估计战争死亡人数
            let count = 940000;

            // 每分钟更新一次（实际应用中应该从API获取实时数据）
            setInterval(() => {
                // 每分钟增加约1.8人（基于每年约100万战争相关死亡人数的估计）
                count += Math.floor(Math.random() * 3) + 1;
                counter.textContent = count.toLocaleString();
            }, 1000); // 实际每分钟更新应为60000毫秒，这里为演示效果加快
        }

        // 页面加载完成后初始化
        document.addEventListener('DOMContentLoaded', function () {
            // 加载行为数据
            loadBehaviors();

            // 初始化计数器
            initCasualtyCounter();

            // 加载页面数据
            loadData();

            const loginBtn = document.getElementById('login-btn');
            const logoutBtn = document.getElementById('logout-btn');
            const usernameDisplay = document.getElementById('username-display');

            // 用户状态管理函数
            function updateUserUI() {
                const user = JSON.parse(localStorage.getItem('currentUser'));
                const usernameDisplay = document.getElementById('username-display');
                const loginBtn = document.getElementById('login-btn');
                const logoutBtn = document.getElementById('logout-btn');

                if (user) {
                    usernameDisplay.textContent = `欢迎，${user.username}`;
                    loginBtn.style.display = 'none';
                    logoutBtn.style.display = 'inline-block';
                } else {
                    usernameDisplay.textContent = '';
                    loginBtn.style.display = 'inline-block';
                    logoutBtn.style.display = 'none';
                }
            }

            // 初始状态
            updateUserUI();

            // 退出功能
            document.getElementById('logout-btn').addEventListener('click', function () {
                localStorage.removeItem('currentUser');
                updateUserUI();
                alert('您已退出登录');
            });

            // 登录按钮跳转
            document.getElementById('login-btn').addEventListener('click', function () {
                window.location.href = 'denglu_xgawy.html';
            });

            // 关闭详情
            document.getElementById('detail-close').addEventListener('click', function () {
                const eventTitle = document.getElementById('detail-title').textContent;
                document.getElementById('timeline-detail').style.display = 'none';
                document.querySelectorAll('.timeline-item').forEach(i => i.classList.remove('active'));

                // 记录行为：关闭详情面板
                recordBehavior(BEHAVIOR_TYPES.DETAIL_CLOSE, {
                    event: eventTitle
                });
            });

            // 幸存者故事筛选
            const filterButtons = document.querySelectorAll('.filter-btn');
            filterButtons.forEach(button => {
                button.addEventListener('click', function () {
                    filterButtons.forEach(btn => btn.classList.remove('active'));
                    this.classList.add('active');

                    const type = this.dataset.type;
                    renderStories(type);

                    // 记录行为：故事筛选
                    recordBehavior(BEHAVIOR_TYPES.STORY_FILTER, {
                        filter: this.textContent.trim()
                    });
                });
            });

            // 数据重新加载按钮
            document.getElementById('reload-data').addEventListener('click', function () {
                const btn = this;
                const originalHtml = btn.innerHTML;
                btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> 加载中...';
                btn.disabled = true;

                setTimeout(() => {
                    loadData();
                    btn.innerHTML = originalHtml;
                    btn.disabled = false;

                    // 显示成功提示
                    showNotification('数据已更新！');

                    // 记录行为：重新加载数据
                    recordBehavior('重新加载数据');
                }, 2000);
            });

            // 查看更多按钮
            document.getElementById('show-more-btn').addEventListener('click', function () {
                const moreContainer = document.getElementById('more-wars-container');
                const isActive = moreContainer.classList.contains('active');

                if (isActive) {
                    moreContainer.classList.remove('active');
                    this.innerHTML = '<i class="fas fa-chevron-down"></i> 查看更多同时期战争';
                    // 滚动到标题位置
                    this.scrollIntoView({
                        behavior: 'smooth',
                        block: 'nearest'
                    });
                } else {
                    moreContainer.classList.add('active');
                    this.innerHTML = '<i class="fas fa-chevron-up"></i> 收起战争列表';
                }

                // 记录行为：查看更多战争
                recordBehavior(BEHAVIOR_TYPES.WAR_CARD_EXPLORE, {
                    action: isActive ? '收起' : '展开'
                });
            });

            // 故事音频播放
            document.getElementById('stories-container').addEventListener('click', function (e) {
                if (e.target.closest('.audio-control')) {
                    const card = e.target.closest('.story-card');
                    const name = card.querySelector('.story-info span').textContent.split('|')[0].trim();

                    // 记录行为：播放音频
                    recordBehavior(BEHAVIOR_TYPES.AUDIO_PLAY, {
                        story: name
                    });

                    // 显示提示
                    showNotification('开始播放音频故事');
                }
            });

            // 故事阅读（点击卡片）
            document.getElementById('stories-container').addEventListener('click', function (e) {
                if (!e.target.closest('.audio-control')) {
                    const card = e.target.closest('.story-card');
                    if (card) {
                        const name = card.querySelector('.story-info span').textContent.split('|')[0].trim();

                        // 记录行为：阅读故事
                        recordBehavior(BEHAVIOR_TYPES.STORY_READ, {
                            story: name
                        });
                    }
                }
            });

            // 资源下载
            document.querySelector('.download-grid').addEventListener('click', function (e) {
                if (e.target.classList.contains('download-btn')) {
                    e.preventDefault();
                    const card = e.target.closest('.download-card');
                    const title = card.querySelector('.download-title').textContent;

                    // 根据标题判断下载类型
                    let behaviorType = BEHAVIOR_TYPES.DOWNLOAD_PDF;
                    if (title.includes('数据图包')) behaviorType = BEHAVIOR_TYPES.DOWNLOAD_DATA;
                    if (title.includes('PPT')) behaviorType = BEHAVIOR_TYPES.DOWNLOAD_PPT;
                    if (title.includes('模板')) behaviorType = BEHAVIOR_TYPES.DOWNLOAD_TEMPLATE;

                    // 记录行为：下载资源
                    recordBehavior(behaviorType, {
                        resource: title
                    });

                    // 显示下载提示
                    showNotification(`开始下载: ${title}`);
                }
            });

            // 实时计数器点击
            document.querySelector('.real-time-counter').addEventListener('click', function () {
                recordBehavior(BEHAVIOR_TYPES.COUNTER_VIEW);
            });

            // 分析按钮点击
            document.getElementById('analytics-btn').addEventListener('click', function () {
                window.location.href = '个人分析.html';
            });

            // 页脚分析链接
            document.getElementById('analytics-link').addEventListener('click', function (e) {
                e.preventDefault();
                window.location.href = '个人分析.html';
            });

            document.getElementById('home-btn').addEventListener('click', function () {
                window.location.href = 'shouye2.0_xgawy.html';
            });
        });
    </script>
    <!-- 页脚版权声明 -->
    <footer class="footer">
        <div class="footer-container" id="footer">
            <div class="footer-section">
                <h3 id="footer-about-us">关于我们</h3>
                <p id="footer-about-text">
                    和平行动是一个国际性非营利组织，致力于通过教育、倡导和人道主义行动消除战争，促进全球和平。我们的使命是创造一个没有战争的世界，让每个人都能在和平与安全中生活。</p>

            </div>

            <div class="footer-section">
                <h3 id="footer-links">快速链接</h3>
                <ul class="footer-links">
                    <li><a href="shouye2.0_xgawy.html"><i class="fa fa-chevron-right"></i> <span
                                data-key="footer-home">首页</span></a></li>
                    <li><a href="guanyuwomen_xgawy.html"><i class="fa fa-chevron-right"></i> <span
                                data-key="footer-about">关于我们</span></a>
                    </li>
                    <li><a href="biaozhi_xgawy.html"><i class="fa fa-chevron-right"></i> <span
                                data-key="footer-logo">标志</span></a></li>
                    <li><a href="https://www.crcf.org.cn/web/woyaojuanzeng/woyaojuanzeng.thtml?classFlag=donate"><i
                                class="fa fa-chevron-right"></i> <span data-key="footer-donate">捐款</span></a>
                    </li>
                    <li><a href="shouye2.0_xgawy.html#war-peace-theme"><i class="fa fa-chevron-right"></i> <span
                                data-key="footer-war-peace">战争与和平</span></a></li>
                    <li><a href="huodong_xgawy.html"><i class="fa fa-chevron-right"></i> <span
                                data-key="footer-events">活动</span></a>
                    </li>
                </ul>
            </div>

            <div class="footer-section">
                <h3 id="footer-contact">联系我们</h3>
                <ul class="contact-info">
                    <li>

                        <div data-key="footer-email">邮箱: 16666666@outlook.com<br></div>
                    </li>
                    <li>

                        <div data-key="footer-phone">电话:12345678910举报热线:110</div>
                    </li>
                    <li>

                        <div data-key="footer-address">地址: 浙江省杭州市滨江区<br></div>
                    </li>
                    <li>

                        <div data-key="footer-wechat">微信:lllllll </div>
                    </li>
                </ul>
            </div>
            <div class="footer-section">
                <h3 id="footer-friend-links">友情链接</h3>
                <div class="friend-links">
                    <a href="https://www.unesco.org/zh" target="_blank"><i class="fa fa-link"></i> <span
                            data-key="footer-unesco">联合国教科文组织</span></a>
                    <a href="https://www.icrc.org" target="_blank"><i class="fa fa-link"></i> <span
                            data-key="footer-red-cross">国际红十字会</span></a>
                    <a href="https://www.tufts.edu/wpf" target="_blank"><i class="fa fa-link"></i> <span
                            data-key="footer-peace-foundation">世界和平基金会</span></a>
                    <a href="https://www.unocha.org" target="_blank"><i class="fa fa-link"></i> <span
                            data-key="footer-aid-network">人道主义援助网</span></a>
                    <a href="https://baike.baidu.com/item/%E5%8F%8D%E6%B3%95%E8%A5%BF%E6%96%AF%E5%90%8C%E7%9B%9F/7459883#:~:text=%E7%AC%AC%E4%BA%8C%E6%AC%A1%E4%B8%96%E7%95%8C%E5%A4%A7%E6%88%98%E4%B8%AD%E7%9A%84%E5%86%9B%E4%BA%8B%E5%90%8C%E7%9B%9F%E5%8F%8D%E6%B3%95%E8%A5%BF%E6%96%AF%E5%90%8C%E7%9B%9F(Anti%20fascist%20Alliance)%EF%BC%8C1942%E5%B9%B41%E6%9C%881%E6%97%A5%EF%BC%8C%E8%8B%B1%E7%BE%8E%E8%8B%8F%E4%B8%AD%E7%AD%8926%E4%B8%AA%E5%9B%BD%E5%AE%B6%E5%9C%A8%E5%8D%8E%E7%9B%9B%E9%A1%BF%E4%B8%BE%E8%A1%8C%E4%BC%9A%E8%AE%AE%EF%BC%8C%E7%AD%BE%E7%BD%B2%E4%BA%86%E3%80%8A%E8%81%94%E5%90%88%E5%9B%BD%E5%AE%B6%E5%AE%A3%E8%A8%80%E3%80%8B%EF%BC%8C%E6%A0%87%E5%BF%97%E7%9D%80%E5%9B%BD%E9%99%85%E5%8F%8D%E6%B3%95%E8%A5%BF%E6%96%AF%E7%BB%9F%E4%B8%80%E6%88%98%E7%BA%BF%E6%9C%80%E7%BB%88%E5%BD%A2%E6%88%90%E3%80%82%E5%8F%8D%E6%B3%95%E8%A5%BF%E6%96%AF%E8%81%94%E7%9B%9F%E7%9A%84%E5%BB%BA%E7%AB%8B%E4%BD%BF%E7%AC%AC%E4%BA%8C%E6%AC%A1%E4%B8%96%E7%95%8C%E5%A4%A7%E6%88%98%E7%9A%84%E5%BD%A2%E5%8A%BF%E5%8F%91%E7%94%9F%E5%8F%98%E5%8C%96%EF%BC%8C%E6%98%AF%E5%8F%8D%E6%B3%95%E8%A5%BF%E6%96%AF%E6%88%98%E4%BA%89%E5%8F%96%E5%BE%97%E6%9C%80%E5%90%8E%E8%83%9C%E5%88%A9%E7%9A%84%E5%86%B3%E5%AE%9A%E6%80%A7%E5%9B%A0%E7%B4%A0%E4%B9%8B%E4%B8%80%EF%BC%8C%E5%B9%B6%E4%B8%BA%E8%81%94%E5%90%88%E5%9B%BD%E7%9A%84%E6%88%90%E7%AB%8B%E5%A5%A0%E5%AE%9A%E4%BA%86%E5%9F%BA%E7%A1%80%E3%80%82"
                        target="_blank"><i class="fa fa-link"></i> <span data-key="footer-anti-war">全球反战联盟</span></a>
                    <a href="https://www.tc.edu/peace-ed" target="_blank"><i class="fa fa-link"></i> <span
                            data-key="footer-education">和平教育中心</span></a>
                    <a href="https://www.warmuseum.nl" target="_blank"><i class="fa fa-link"></i> <span
                            data-key="footer-history">战争历史档案馆</span></a>
                    <a href="https://www.unhcr.org" target="_blank"><i class="fa fa-link"></i> <span
                            data-key="footer-refugee">难民救助组织</span></a>
                </div>
            </div>
        </div>

        <div class="copyright">
            <p id="footer-disclaimer">
                <strong>免责声明</strong>: 本网站部分内容源自网络，版权归原作者所有。如有侵犯您的原创版权，请告知，我们将尽快删除相关内容。
            </p>
            <p id="footer-compliance">
                本网站严格遵守《互联网信息服务管理办法》及《网络信息内容生态治理规定》 | 已接入长沙市互联网违法和不良信息举报中心
            </p>
            <p id="footer-copyright">
                © 2025 和平行动国际组织 版权所有 | XX网安备 114514666888号 | ICP备案号: 浙ICP备1008666号-1
            </p>
        </div>
    </footer>

</body>

</html>